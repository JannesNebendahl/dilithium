import 'dart:typed_data';

import 'package:dilithium/dilithium.dart';
import 'package:dilithium/src/poly.dart';
import 'package:dilithium/src/poly_vec.dart';
import 'package:test/test.dart';

import 'test_helper_functions.dart';

void main() {

  group('PolyVec', (){
    test('length', (){
      final pv = PolyVec(3);

      expect(pv.length, 3);
    });

    test('add', (){
      final pv1 = mockPolyVec([[1, 2, 3]]);
      final pv2 = mockPolyVec([[4, 5, 6]]);
      final expected = mockPolyVec([[5, 7, 9]]);

      PolyVec actual = pv1.add(pv2);

      expectPolyVecsAreEqual(expected, actual);
    });

    test('add throws PolyVectorLengthMismatch', (){
      final pv1 = PolyVec(3);
      final pv2 = PolyVec(4);

      expect(() => pv1.add(pv2), throwsA(isA<PolyVectorLengthMismatch>()));
    });

    test('sub', (){
      final pv1 = mockPolyVec([[4, 5, 6]]);
      final pv2 = mockPolyVec([[1, 2, 3]]);
      final expected = mockPolyVec([[3, 3, 3]]);

      PolyVec actual = pv1.sub(pv2);

      expectPolyVecsAreEqual(expected, actual);
    });

    test('sub throws PolyVectorLengthMismatch', (){
      final pv1 = PolyVec(3);
      final pv2 = PolyVec(4);

      expect(() => pv1.sub(pv2), throwsA(isA<PolyVectorLengthMismatch>()));
    });

    test('randomVec', (){
      final rho = Uint8List.fromList([1, 2, 3]);
      final expected = mockPolyVec([[0, -1, -1, -1, -2, 0, -1, 0, -1, -1, -2, 2, -2, 0, -2, -2, 1, 1, 2, 2, 2, -2, -1, 1, -2, -2, -2, -1, 1, -2, 1, -2, 2, -2, -2, 0, -2, 0, 0, -2, 1, 1, -2, -2, 2, 0, 2, 0, -2, -2, -1, -1, 1, -2, -1, -2, 1, 2, 1, -2, 2, -1, 0, -2, 1, 0, -1, 1, 0, 2, -1, 1, 2, -2, -2, -2, -1, 1, -1, -2, 1, 1, 1, 1, 2, 2, -2, 2, 2, 1, -2, 0, 0, -1, 2, 0, 2, 0, -1, -1, 0, 1, -1, -1, 2, 1, 1, -2, 1, 1, -2, 2, 0, 2, -1, 1, -2, -1, -2, 0, -2, -2, 0, 2, 1, 2, -1, -1, -1, 0, 1, 1, 0, 0, 2, -2, 1, 2, -1, 1, 0, -1, 1, 2, 2, 0, -1, -1, -1, 1, 0, 1, 1, -2, -2, -1, 0, -2, -1, -2, -2, -2, 2, -1, 1, -1, 2, 2, -1, 1, 1, 1, -1, 2, -2, 0, 1, -1, 0, 2, 0, -2, -1, -2, 0, 0, 1, 0, -2, 1, -2, 0, 1, 1, 2, 1, 1, -1, -2, -1, -1, 0, -2, -1, -1, 0, 1, 1, 0, -1, 0, 0, 1, -1, 2, 2, 1, -2, 1, 2, 0, 1, -2, 2, 1, 0, 2, 2, 2, 0, -1, 2, 1, -2, 2, 1, 1, -2, 0, -1, 0, 0, -1, -1, 2, 1, 1, 1, -2, 2, 2, -1, 2, -1, 1, 0]]);

      final actual = PolyVec.randomVec(rho, 2, 1, 123);


      expectPolyVecsAreEqual(expected, actual);
    });

    test('ntt', (){
      List<int> coef = List<int>.generate(Dilithium.N, (index) => index + 1);
      final pv = mockPolyVec([coef]);
      final expected = mockPolyVec([[-4135435, -3344473, -3055472, 5167776, -1630539, -9190453, -1567068, -5609240, 2953865, 2303047, -277368, 6846472, -3398746, -7829548, -3111497, -4684041, -11503494, -10540608, -7218827, -14754235, -11250256, -12982310, -6721664, -11071862, -2227214, -6740032, -4352502, -7293644, 3794733, -632975, 379257, -6744463, 5806729, 14045305, -1191916, 5883394, 6906919, 5159485, 1190806, 7436646, 3049741, 1941269, 9037482, 6449592, -842223, -7762487, 1763007, -5633573, -4912329, 2341473, 3884128, 1920696, 4260396, 2377112, 7082801, 5777763, 1361595, -1074011, -5449997, -7494683, 4404458, -3646556, -5222842, -714660, -6282670, -2238258, -6851546, -1813642, 889868, 750598, -8191724, -5746386, -2360042, 5821440, -9277894, -1397772, 4275052, 2324256, 6949029, 12222763, -1462736, -733486, -8938113, -9111949, -1060853, -1277263, -8221007, -4206745, 6722027, 9073249, 1773523, 8296013, -1260527, -4674905, 3789894, 2877790, 3734413, 9726831, 5343398, -482878, 7593110, 4595836, 797414, 6341380, 1604224, 524012, -1906322, 2448170, -5660104, -8181856, -6112055, 1294027, 11614107, 4201231, 7329319, 4679927, 17121567, 10824181, 10785829, 12487311, 2976675, 3178183, 7096501, 9698117, 552129, 1259175, -4219100, -6025808, -380294, 4519604, -5011939, -1612211, -526318, -4914110, 2847473, -20317, 4304310, -248426, 2999210, 768494, -10700439, -5394179, -2604541, -3999293, -10171170, -11292386, -205587, -8498781, -345058, -3232282, -9955966, -5728362, -5511867, -2533773, -11512325, -9975459, 1224235, 6424577, -744902, -6155822, -753286, -6713376, 288143, -1458001, -5660572, 1320940, 1507077, 8689371, -10335717, -2309019, -1031171, 1431219, 3704562, -2023452, -3160528, 4356674, 1775775, 1398849, 13625832, 5643800, -284579, 2229435, 734655, 4602649, 6521345, -770715, 10653089, 7564397, -60353, -3026705, -4663993, 2052807, -4930, 80178, 6604383, -1605599, -3106901, -2373513, 1685083, 3581203, -5029020, -10170234, -7728795, -1230827, -2800132, -2546366, -3336208, -8909090, 1384350, -6676064, -1181982, 4946116, 2332153, -5762859, 617338, 863180, -2892532, -9438784, -6820323, -2821793, -8224215, -3671611, 569879, -1760789, 5398633, 7070759, 975957, 6094575, 4437087, 5927585, 4386302, 1688494, 3689438, 7151762, -1469031, 3578011, -3963670, 1591406, 1893055, 1950421, 2659622, 3219442, 8869343, 3962377, 10773003, 12684925, 6781776, 8304040, 3043756, 3922682, 5490764, 4384118, 234782, -7219700, -391480, 7057846]]);

      final actual = pv.ntt();

      expectPolyVecsAreEqual(expected, actual);
    });

    test('pointwiseMontgomery', (){
      List<int> coef1 = List<int>.generate(Dilithium.N, (index) => index + 1);
      List<int> coef2 = List<int>.generate(Dilithium.N, (index) => (index + 1) * 2);
      final pv = mockPolyVec([coef1]);
      final p = Poly(coef2.length)..coef = coef2;
      final expected = mockPolyVec([[-229184, -916736, -2062656, -3666944, 2650817, 129793, -2849599, 2093058, -1803070, 2222851, -2590013, 519172, 3169989, -3017979, -1283898, -8185, 809160, 1168137, 1068746, 510987, -505140, -1979635, -3912498, 2076688, -772911, -4080878, 533204, -3691499, 5847, 3244825, -2354982, -32740, 1831134, 3236640, 4183778, -3707869, -3677467, -4105433, 3388650, 2043948, 240878, -2020560, 3640051, 461877, -3174665, 1110842, -3442436, -73665, 2836738, -3091644, -1097977, 437322, 1514253, 2132816, 2293011, 1994838, 1238297, 23388, -1649889, -3781534, 2008870, -1039511, 3834157, -130960, 3825972, -1055881, 1984315, -3814274, -1690814, -25722, 1181002, 1929358, 2219346, 2050966, 1424218, 339102, -1204382, -3206234, 2713963, -204625, -3581581, 963512, -3330180, 298177, 3468166, -2200630, 52623, 1847508, 3184025, 4062174, -3898462, -3937049, 3946413, 2991090, 1577399, -294660, -2625087, 2966535, -280628, -3986159, 230359, 3988509, -1092126, 1749288, 4132334, -2323405, -857095, 150847, 700421, 791627, 424465, -401065, -1684963, -3427229, 2752554, 93552, -3023818, 1780861, -2253245, 1634698, -3316144, -344937, 2167902, -4158044, -2561941, -1424206, -744839, -523840, -761209, -1456946, -2611051, 4156893, 2086052, -443157, -3430734, 1503738, -2400575, 1617161, -3203888, -102888, 2539744, -3656409, -1930513, -662985, 146175, 496967, 389391, -176553, -1200865, -2683545, 3755824, 1356408, -1501376, 3562889, -211631, 3935898, -755358, 2475435, -3132557, -818500, 1037189, 2434510, 3373463, 3854048, 3876265, 3440114, 2545595, 1192708, -618547, -2888170, 2764256, -422103, -4066830, 210492, 4029446, -990385, 1911833, -4024734, -2039252, -512138, 556608, 1166986, 1318996, 1012638, 247912, -975182, -2656644, 3583943, 985745, -2070821, 2794662, -1178640, 2770107, -2119931, 912080, 3485723, -2779419, -1122512, 76027, 816198, 1098001, 921436, 286503, -806798, -2358467, 4011913, 1543508, -1383265, 3612011, -231498, 3847042, -913203, 2248601, -3428380, -1183312, 603388, 1931720, 2801684, 3213280, 3166508, 2661368, 1697860, 275984, -1604260, -3942872, 1640565, -1614783, 3051918, -1120166, 2629799, -2459021, 374208, 2749069, -3714855, -2256730, -1256973, -715584, -632563, -1007910, -1841625, -3133708, 3496258, 1287439, -1379748, 3875114, 291191, -3751100, 128658, 3550048, -1867347, 637307, 2683593, -4108906, -2979356, -2308174, -2095360]]);

      final actual = pv.pointwiseMontgomery(p);

      expectPolyVecsAreEqual(expected, actual);
    });

    test('mulMatrixPointwiseMontgomery', (){
      final pv = mockPolyVec([
        [3406061, 1380303, -1146251, -2991281, -2352752, -10334998, -5005624, 536270, 2372355, 6976301, 6766546, 11974774, 2135737, 1463285, 807333, 1717557, -312254, -4109922, 1076601, -5892633, -6766959, -14296183, -7655865, -12824449, -1635885, -7762033, -4712231, -3694991, 1476530, 791464, -8119595, -775659, -13380070, -18481374, -15614557, -9707719, -12188427, -6818317, 989490, -6027834, -5152887, 2918531, -6341104, -396988, -3347006, -9298842, -15222682, -10014358, -5713857, -13982023, -10315319, -17710569, -7940156, -7019776, -51827, -72929, 800090, -3389208, 1593730, -2260612, 4429369, -3776819, -6083463, -8403959, 3977213, -1467713, 2803427, 6280205, -6812886, -2168408, -2083071, 3849105, 4286856, 8474862, -2835578, 4421732, 6747060, 3056948, 11701999, 8986809, 4168160, 1854470, -236529, -6978561, -363343, -7109917, -8432636, -14739676, -5636968, -3169710, -2302709, -4196757, -5834343, -4366567, -11385517, -6889781, 11373972, 13245684, 5961894, 11798750, 1438233, -741759, 8147493, 5336525, 3936614, 3712728, 5608316, 1524178, -5395126, 2187304, -7837877, 267599, 571716, 1924164, 6468524, -977108, 1713217, 215361, 5692490, 7014548, 868235, 3817359, 4215289, 3854457, 8448071, 12149387, 4574595, 12572751, 8150694, 578634, 7002346, 5290882, -8205217, -690371, 2479502, 520930, -1324791, 1858697, -8859825, -5578937, -1155843, -9424117, -6108698, -10557438, -3189418, 441716, -7328349, -9728945, -6454026, -5004812, -8646792, -5798838, -13956616, -7293446, -8513655, -724915, 208836, 4434310, -5034678, 2586524, 1642647, 7814595, -3298294, 2290160, -2993407, 2116683, -5128356, -5765588, -856466, -5595686, -7480110, -8227534, -10653827, -11337227, -2192962, -8296356, 834578, 7835046, 1236539, 3167521, 3085899, 11173909, 10678112, 10962396, 5788202, 10440564, 3491551, -3264269, -8369306, -2895252, 1795412, -4996134, 8743366, 15930020, 7274423, 5239995, 7555405, 3047211, -5773123, 2505519, 7428957, 14912129, 12466464, 19222246, 13090438, 5465158, 9530610, 6118958, -2238455, 4858203, 11636501, 4318435, 16105325, 15740435, 8966390, 6613142, 4200152, 6923762, 6266490, -1144328, -5085335, 2812825, -4936865, 47883, -5420473, -7800747, 553217, -3853885, -2422965, 4654595, 9343981, 2715037, -4377582, -11963530, -5686954, -2487490, -2114980, -9704470, 1466994, 1668676, 8592685, 13944439, 7512806, 8277954, 7751259, 11264311, 1914054, 1240788, 7690608, 8682770, 9444578, 5041884, -3035881, 2891475, -2869923, 4472465],
        [692913, -3689027, 914541, 1600585, -4771745, -2975625, -6531814, 603020, 8491259, 2533761, -4131532, -58080, -1826034, 458548, -2087658, 903352, -458485, -3847959, 102189, 312895, -9802881, -15533179, -5907735, -4192573, -2814381, -9895663, 1044577, -4812029, -7947758, -9072042, -11687117, -10538579, -5225085, -3341259, -12590511, -7342749, -5240042, 2779110, -3685407, -11888609, -13011327, -10647251, -14125985, -16506337, -11834813, -10833417, -18367451, -16048115, -1237514, -1793166, -12429969, -7305771, -6337161, -2931661, -8309519, -15057791, -17396962, -12219248, -10772746, -17140588, -8050270, -9334472, -13510350, -8087532, -175831, 4654845, 332650, 26428, 10725450, 9432858, 1133347, 8569333, -393599, 5506255, 1816471, -3968111, 6099178, 3621396, 4617736, 3523866, -166101, 1003285, 2866173, 10475703, 1464055, -1652031, -8940171, -7522041, -825655, 6632449, -8623975, -1455627, -580851, 3695873, 9252178, 1502944, -10883854, -2552906, -3154327, 2191599, -2383527, 1282339, 4534617, 7626083, -3168477, -7714459, 2464487, -1647431, -6161912, -2361814, -12937655, -5155339, 7161421, 1645893, 2581535, -5081137, -3210040, 1299918, -7401962, -4419364, -4078299, -10018347, -7446440, 519058, -11672342, -11566128, -3879302, -9556944, 5766737, 5002703, 5060461, 1412303, 7318566, 2552840, 6977808, 4111710, 4011881, 6280127, 11678795, 13277681, 12394055, 7122529, 18518516, 16905960, 1248316, 7374692, 4507971, 12409449, -393130, 1294708, -2092649, -812061, -9523370, -1980240, -6474685, -699553, -3925870, -3075252, 2925607, 984707, -3368980, -1801798, 2947247, 3034123, 1562111, 6626257, -5050349, -2337283, -1354939, -6479073, -4592100, -3248852, -2095178, -7883980, -7088302, -11239528, -5014713, -1623759, -6703337, -8969827, -4799162, -11568062, -10424518, -5914406, -6957297, 897021, -2871116, 2004860, 5667556, 4484036, 7021097, -784757, 10273495, 11162515, 8837104, 4483074, 9189460, 12501618, 4104605, 1852897, 12715737, 14310131, 8687587, 3297381, 4588159, 8139415, -1408760, 3086766, 17130832, 11526162, 5877390, 8373364, 11731503, 12339531, 3110963, 6989959, 17022200, 9884234, 13837924, 13764010, 18284149, 12618399, 12657009, 18979891, 7892862, 3024662, -1464956, -287256, -10062345, -4056525, -4668122, -1539808, 6785416, 1647308, 6812124, 6766268, 2446677, 869799, -611385, -5821471, -1077949, 2172795, 4703272, 5041238, 7994631, 1452949, -3251017, 1435561, 13817611, 15509489, 6477766, 12191186, 10982814, 2945818, 4451143, 12480725],
        [14623751, 13551377, 10023243, 8348781, 15039508, 11712632, 13056380, 6929448, 4535680, 9559836, -1775527, 4839551, 532887, 5954237, 10160681, 1788207, 2084922, 7937732, -4583092, 2402730, 6270925, 3327993, 6683760, 2874750, 4805109, 97631, 13775287, 6233897, 1228702, -1002432, 6627228, 2181930, 5119962, -160006, 4679324, 8821560, 388695, 796391, 3722515, 7874471, 4739975, 1746705, -1927186, 2025030, 1097409, 1410817, -5893280, -5373822, -17816112, -14758556, -9912718, -9547622, -6778034, -9051286, -5060442, -5683446, -6907256, -5236150, -6845224, -4533030, 2473655, -5571909, -398938, 6130892, 12940868, 12438858, 12702269, 19666493, 11517353, 10618533, 10404327, 6284979, 5269103, 5199051, 12711956, 6742910, -82315, 962309, 3551654, 1877620, 164962, -3149816, -5757971, -4682771, 9356588, 2918958, 4605349, 158973, 2350595, 4087091, 9855198, 7183684, 9124489, 7703875, 4958366, 7571598, 15242985, 8119323, 8751261, 14343863, 9955455, 2147745, 14757085, 8346227, 12065797, 4254243, 9532077, 8407115, 1947580, 4973770, 1141648, -1156222, 132180, -4308992, 571222, -1877306, 7865640, 8765614, -1184462, 3519392, -3266456, -6625064, 48597, 2239139, 880749, 6593137, 2202359, 10203323, -11399853, -4008059, -16440954, -13967122, -4235697, -3999895, -7679202, -12220490, -3309185, -122433, -6981181, 877783, -14804845, -8991531, -5846706, -13013334, -197419, 5335259, -1302914, -3461426, -4148225, -3578299, -2854906, 2039650, -3298780, -4363448, -13942226, -10028286, 2615351, 3326373, 999083, -6347067, 1771490, 2257084, -8152151, -3498223, -4564122, -11993248, -9912573, -8146113, -6800702, -225090, 3600235, -127659, -6108828, 2003662, -4859509, -11625229, -6556995, -3030743, -13245855, -5278107, -4400434, -1832540, -314289, -607837, -5027122, -11121774, -17527870, -13068346, -11738537, -7325487, 1656677, -6694197, -2598273, -9538499, 1851900, -4626432, -8513311, -11872809, -11931635, -10268813, -1478033, -2786597, -6268111, -8698531, -9265290, -5931502, 3651048, -3738376, -4692696, -3303314, -14215236, -10464098, -10589268, -9851590, -11748193, -4248261, -2581557, -6922443, 7664196, -619164, 2436816, -4112766, -5038159, -10677835, 4855280, 8201268, 9624645, 11152023, -3511551, 4471181, 2347380, 3861470, -145062, 7537398, -4322486, 355498, 3637717, 5098217, -5514394, -1024744, 10356386, 11298852, 4338139, 769719, 563996, 3390692, 1193634, 7017646, -1999429, 3744439, -3525658, 2317696, -538126, -6699142, -5936593, -11339643],
        [-5882395, -5745359, -9978383, -7199971, -4035696, 1609432, -3992983, 826715, -1609553, -1510259, 4783758, -2796162, -1918072, -10296822, 4662354, -3093596, -5789072, 1570904, 5835380, 108872, -5298791, 1245823, 4436182, 7122862, -407644, 6518856, 11733752, 6305156, 3441826, 6335672, 7051518, 8561408, 1042309, -5817345, 572121, 5388727, 3613354, -4309506, -2560504, -10904516, 2575248, 802972, -5786811, 1481971, 629005, -3214543, 5298063, -107777, 6365780, 2255774, -3104212, 4556106, 8243058, 8666528, 3648220, 3979418, 3747056, 8417704, 9369764, 2833084, -966658, 4759850, 3709078, 11847274, -2868092, 1556588, -3294977, 3559713, -7285387, 781175, 213450, -3977230, -113483, 1674289, 1751186, 2281092, 12697925, 7518697, 6761613, 11081793, 10358185, 16137405, 11278975, 6224143, 9701199, 3201957, 9312531, 12842693, 9499089, 15952641, 5444160, 8340530, 7315895, 2702547, -3067185, 2702803, 793526, -2002832, -11932604, -5854498, 1814503, 5609049, 651082, -620218, -5289449, -13440467, -12681241, -11337019, -1066729, 2156663, -7922894, -3829448, -4906300, -3368670, -5125032, -904226, 1450333, 3694435, 3247775, 20365, -8975185, -3011157, -3695858, -3693368, 7290402, 3554510, -5018061, 2684933, 5896109, -54641, 11446331, 3191777, 2985727, 99483, 1750314, -3842852, -1641175, -5668045, -1265794, 207366, -5692247, -1752037, -710178, -6545706, 543242, 4629886, 12908628, 8624136, 11138862, 5764462, -1165253, 5611853, 3970613, 1435727, 5297371, 4919729, -3002943, 5076361, -4804384, -3316338, -16824, -7403240, -7859842, -14865938, -8245235, -11802141, -18238844, -10054928, -7288354, -4706144, 2244259, -2492785, -5192823, 349235, -2349460, -4857624, -6376045, -7005997, -2863982, -3241248, -3817428, -3595722, -11810199, -9495011, -3643077, 885711, 5099736, 2808514, 4390453, -891715, 6280150, 394116, -4251623, -2653323, -10562266, -12271896, -8675832, -7917258, -3146490, -11245536, -7094295, -444737, 471788, 6235972, -6992019, -4343041, -8564588, -5191336, -1190175, 125785, -4351695, 1062849, 6857046, 7929424, 5534194, 1431076, -460775, -3570899, -5027533, -3686977, 8896473, 5741925, -640211, 1495685, 11763463, 12866045, 2846477, 8610003, 4283294, 4013972, 3101880, 10108346, -868370, -8768746, -392817, -442499, 3527379, 5344815, -1905433, -832945, -11099791, -6933449, -15626072, -7701636, -5635117, -1363369, -7810490, -1099476, -722932, -1127204, 3855298, 1384094, -2279767, -3819309, 906568, -6259908]
      ]);

      List<PolyVec> M = [
        mockPolyVec([
          [1682926, 4935596, 5554513, 1083260, 6792170, 8082604, 4039519, 552642, 5923948, 6131267, 2854525, 4207590, 7551778, 506231, 1665840, 6314218, 5320288, 6945266, 4461624, 2543718, 2551748, 3366562, 7383134, 8077812, 2085638, 6878054, 3665877, 555142, 2418479, 7206173, 5554353, 1421158, 3353670, 3226199, 5835209, 3168146, 604798, 8062901, 6296127, 4530640, 7923409, 6817622, 7534136, 6091562, 7311550, 1361354, 3081898, 1359315, 2897912, 7603752, 6518898, 85462, 2466235, 6525317, 1812307, 4252046, 2257401, 1751474, 5177119, 3532567, 3474240, 535044, 7788754, 1430524, 7717520, 7981649, 61516, 6955883, 5920159, 8266672, 2473721, 7717823, 2862353, 927345, 1329617, 1280936, 2732976, 8326639, 1029837, 1509306, 6753065, 6659957, 5611735, 156328, 5477409, 5559049, 4265627, 5950878, 6960543, 2326380, 4920041, 2110806, 464318, 839824, 5935308, 7215023, 120269, 6658199, 4638237, 95199, 476188, 5045778, 7890438, 2685778, 289517, 3580375, 1337092, 6681911, 6560958, 1413859, 873727, 5938596, 2657682, 5609553, 3129641, 3620403, 4087725, 7418681, 283241, 7552454, 1439223, 368158, 6421416, 928652, 4581378, 6665035, 4286202, 1801947, 3924392, 3043822, 4594835, 5031556, 7059134, 2930824, 3908989, 3597615, 4549827, 3197873, 4243171, 3700871, 4869536, 2667249, 3346775, 4909726, 5952937, 3046053, 3560361, 5766039, 5048260, 2249406, 8202513, 996869, 292717, 1211198, 6729225, 3415892, 1464767, 7950722, 5881170, 4403384, 2049357, 7558669, 2080668, 5835748, 5675490, 5231048, 3543745, 7165497, 6453254, 5457610, 6679552, 3581703, 5194424, 7957913, 8113085, 2882983, 5294182, 4995453, 1427913, 6932393, 8271020, 4744858, 3839386, 1419352, 1497556, 7328857, 8364797, 3349731, 711571, 6837528, 4911380, 2212861, 7218374, 3697280, 3325455, 6328871, 2500881, 6590828, 3350307, 7249763, 8362147, 6850014, 924586, 5575913, 7144871, 2858089, 8297285, 4940557, 7714167, 714340, 748641, 6060003, 337074, 3775557, 7582022, 782299, 7937734, 4281004, 7829069, 4107968, 6052796, 5709509, 6626414, 7670227, 6234602, 5967359, 2094988, 3782344, 344017, 4235743, 8041584, 4675844, 6286611, 3439623, 5714577, 6791866, 1957050, 6718333, 7084234, 2359849, 1963410, 6054306, 6617477, 1767662, 3971004, 7685620, 6964093, 6796847, 7721946, 2379459, 722603, 4142962, 1240906, 7390626, 7024003, 6998370],
          [2954289, 6272766, 3901481, 3810331, 531977, 831168, 4992755, 489324, 8321930, 4802324, 1661255, 6852135, 3293705, 4259077, 6768310, 2636117, 1355576, 7000850, 3227935, 5726604, 508776, 1160355, 6375705, 2285506, 315963, 3285768, 3897595, 5524618, 5175138, 3367690, 8175074, 4846751, 4159307, 274703, 3128820, 6026200, 7148015, 2229375, 7447031, 2017589, 1310349, 3988553, 2019594, 245085, 3494324, 6090038, 3587709, 597228, 7276116, 2392854, 2277553, 1042082, 5582541, 6938083, 1896475, 8313340, 2665124, 981579, 3079887, 4320276, 4425249, 2804372, 2311748, 4306216, 8215654, 4293175, 6173766, 7368796, 198444, 8277143, 3665207, 6254284, 764094, 6108554, 3492784, 444755, 3031278, 2348243, 4461101, 5073006, 7660127, 6353730, 2063109, 5855428, 2743398, 6243995, 6380691, 1772842, 60108, 3234402, 440762, 36569, 3380223, 3136770, 3571154, 2094556, 4954693, 871630, 7882715, 7245633, 5450188, 3237750, 5825523, 7858210, 7422253, 1359881, 6384318, 6967093, 7033322, 4843373, 6037091, 1745929, 3793247, 3160735, 1426034, 1818116, 4015803, 2990496, 5640151, 6201120, 423036, 7174143, 1652627, 7457075, 7014013, 7979175, 6176850, 3482550, 7183581, 7538136, 4210136, 92112, 5628242, 3847637, 4752582, 3859347, 1235382, 8093043, 3543407, 1129444, 434866, 3018055, 695423, 8109097, 1079962, 7758221, 1571626, 5889354, 2490436, 7499922, 5913103, 271842, 449596, 5712736, 7067535, 221964, 6623906, 6050636, 5622447, 5254877, 3952434, 649014, 6078697, 4510344, 1120372, 4028029, 3613305, 5201571, 6349637, 358681, 6529698, 7267739, 421926, 5717729, 1036035, 3089376, 7136882, 8305032, 5196482, 3707365, 2013001, 7902820, 4155407, 526446, 5782699, 5444136, 5022642, 1435538, 826431, 6851024, 6205463, 4345655, 3213313, 3388666, 5343811, 1424513, 6481586, 3039389, 2927696, 5865412, 8172386, 2967539, 519080, 3374090, 1470857, 5350766, 7578578, 4671136, 4230296, 2219332, 1103977, 7409615, 3910696, 7001361, 6982020, 2901327, 39780, 2491659, 4585550, 101526, 6144999, 4649506, 6834748, 4972839, 5329163, 2316269, 7787176, 5491967, 6743644, 7380644, 3436252, 1987241, 6015708, 1990237, 5078247, 1729083, 771905, 4678415, 7735175, 5825710, 1755135, 200545, 2976355, 5013261, 1050, 6072592, 3345843, 5360278, 3078748, 93626, 858308, 1509617, 3737671, 1388503, 563081, 7896658],
          [6152460, 6528656, 84426, 1750369, 3372300, 4913221, 4398042, 6696503, 6098312, 2598151, 4226284, 726877, 6663282, 1707970, 6620660, 4512696, 2310063, 7941144, 4920237, 222455, 59394, 6750226, 1772872, 493296, 5956196, 4433862, 7548742, 7884915, 6320940, 8165329, 6752572, 3683658, 4788932, 1792391, 330246, 5520138, 4480822, 3159225, 8134592, 8035517, 1927680, 268124, 8210090, 3893072, 6015426, 6376728, 5116853, 5888839, 2681076, 5276806, 2415447, 683503, 7269074, 2288911, 7829749, 4661234, 794884, 6619132, 5704220, 4031881, 7218621, 2669070, 747680, 2898853, 4288596, 2135132, 8110928, 1318618, 158929, 3412094, 5691057, 2631190, 3613989, 1337856, 1573765, 1758019, 6661523, 6009490, 5169789, 124596, 4431705, 1191638, 1714615, 4806190, 25990, 4219191, 7755062, 5445458, 5281480, 3644437, 5658971, 1759140, 4072991, 5223988, 4666491, 2280185, 3093506, 8346938, 3929781, 5728102, 752744, 733876, 8039304, 4783063, 126815, 4663198, 2503512, 2493343, 5645962, 5123142, 7392666, 1646145, 5394791, 8216743, 2376113, 2108845, 307664, 2489284, 7731301, 5460796, 5420874, 4194331, 1268931, 6307679, 2805453, 8345185, 4791749, 2547891, 4653986, 7231008, 828389, 1574179, 6011007, 3364297, 8360623, 933850, 1011259, 1511374, 1195949, 1628649, 1149611, 6351027, 2730594, 7364279, 7932165, 3417207, 3890390, 4314618, 1525792, 6396553, 7479932, 1554128, 3884081, 1799508, 6148146, 1106233, 3257354, 3502069, 7401024, 4117842, 3181136, 1731992, 2674487, 5545579, 2289920, 4973783, 1342864, 4376646, 5842977, 160489, 6891881, 5049831, 2491265, 3212198, 5906194, 2131500, 3761245, 6282525, 3822491, 256235, 3881796, 2701613, 3367267, 3167078, 416952, 2916034, 3991222, 4081767, 579518, 1981088, 4156429, 2414867, 2535376, 3700554, 6924269, 19414, 2901831, 4692532, 2543686, 3537721, 5751670, 133080, 7309623, 6736285, 7565161, 3982509, 2934905, 8349130, 700037, 2505141, 6516146, 2486197, 3143077, 5215082, 3281240, 5789240, 678758, 1303402, 4243789, 6342204, 3077081, 8369834, 864688, 2526653, 88406, 4405139, 5350078, 7264070, 6656303, 4142655, 4620950, 5535493, 4359986, 981452, 2386220, 8288905, 7697281, 8192668, 1507430, 4386002, 3133052, 4670225, 3475479, 3161751, 2282698, 2351445, 7984112, 4616644, 3551178, 7551940, 344491, 255685, 3168035, 2254648, 4694560, 1888630],
          [667481, 6696925, 1162124, 3654562, 2256690, 6502564, 8169815, 5298677, 2956240, 1015062, 8332275, 1650300, 5140437, 6727168, 7214715, 3919670, 7809476, 3726005, 6800967, 510493, 6859602, 7092244, 3602456, 4314034, 1320551, 207957, 1919604, 1657271, 1721335, 6075800, 2129261, 1010087, 2513514, 5214948, 1607647, 1822192, 4612026, 926698, 3463507, 2320384, 7195651, 1235655, 8379941, 1630926, 1036998, 3658519, 7393161, 2588454, 6577418, 6100688, 6373041, 6447359, 1508167, 2946284, 880053, 1100068, 1476775, 5211890, 3274710, 1973194, 3327228, 2620799, 2577793, 1227128, 1143763, 5199182, 7279494, 1118537, 4581704, 6056509, 6744452, 8379421, 5078361, 1959758, 2409073, 7287507, 7844746, 3119101, 2149290, 7631324, 632646, 8182959, 3690424, 1019501, 1506388, 2255764, 1975849, 4651461, 5325861, 2111915, 2049345, 3032650, 3726585, 7934539, 880220, 5215384, 736219, 1516473, 2339131, 1753128, 1123161, 6403784, 4653988, 6879713, 227238, 1123983, 1988721, 4582711, 7753440, 2123433, 5572846, 1763400, 2573547, 4636583, 3805838, 2848348, 3231316, 3198129, 7149296, 5704543, 1633363, 7485358, 1053101, 5306443, 3814769, 43427, 3917424, 1561872, 2711941, 2781702, 6672471, 2490502, 1335873, 4285206, 331325, 6992728, 1978234, 4264463, 7813903, 6375576, 3727275, 1815155, 2262625, 6977928, 5332145, 1820536, 5298886, 1710947, 5416769, 7326030, 318901, 1786858, 1877268, 5533929, 4290358, 7268807, 6981514, 1478206, 772886, 3136361, 5183586, 859443, 3876250, 7795953, 7676680, 4377866, 6398652, 581327, 1412693, 6546667, 7913430, 185035, 4177051, 2215356, 729416, 4413715, 3416636, 4907841, 2596985, 1684070, 560623, 5437375, 6067594, 3870832, 3131377, 3105854, 4687981, 2550454, 6336761, 7408627, 1732599, 4473731, 371089, 6785028, 4519108, 2577813, 7313559, 7916167, 6816353, 3200619, 704921, 3240075, 6945206, 7682730, 5559010, 2741965, 3994293, 2016521, 3110580, 3524813, 6521221, 1335450, 5260405, 4374139, 4614591, 5954520, 5005691, 2042385, 331532, 7670143, 2945605, 6829747, 1130484, 4785831, 792622, 6590807, 88394, 5564980, 8268196, 313326, 2983922, 3282677, 2075491, 2994920, 6970103, 7824666, 3676829, 6116253, 6863317, 3182555, 3232046, 8135696, 5910936, 1365990, 2405013, 3653205, 6964029, 6693345, 3391599, 5731218, 8122585, 3150937, 5101896, 1517296, 7558694, 8169149]
        ]),
        mockPolyVec([
          [4471792, 818951, 4474478, 5591587, 5147192, 8233880, 5724261, 851586, 2155835, 4325414, 4442974, 2229550, 1162633, 6789141, 3503252, 1869128, 5270838, 6571932, 2312297, 4419211, 4285583, 7334928, 6854761, 6948578, 5549028, 3826564, 530270, 7701235, 2513829, 3153654, 6355875, 8250489, 3713500, 8154877, 5250553, 2563062, 5605267, 2151416, 1402992, 2032754, 7171392, 5755282, 2201234, 2121199, 2384288, 2427563, 564924, 8171054, 2017076, 8071782, 3741564, 4217822, 2833835, 285133, 554375, 3858578, 1903612, 2351509, 732190, 6079146, 1964812, 1704662, 7007822, 3923242, 5140983, 7733809, 700625, 3216439, 4623940, 3878679, 1419690, 2282797, 3463313, 3153450, 5849204, 4269880, 5894210, 3620266, 8125052, 3058375, 1432024, 3131125, 5736807, 8158228, 1414126, 3045987, 396081, 2373053, 7069671, 2650918, 7685506, 8041486, 1514267, 6173748, 1108704, 578183, 4231593, 2076903, 8280195, 5931626, 6422289, 1570420, 3322351, 7065724, 1850742, 1050526, 8120794, 268705, 6010624, 896299, 3270466, 5972177, 3935134, 3943285, 2811970, 7202930, 159262, 3131259, 285281, 6907440, 5471786, 7789985, 6029678, 6992810, 1318309, 4529049, 1353817, 2707687, 1656301, 3086850, 4232609, 3182394, 7170979, 5277394, 3097759, 805400, 4285386, 3203437, 2788160, 5271073, 6051954, 4891964, 5042733, 6100302, 7170002, 6543232, 473138, 4163679, 2656300, 4755507, 4865270, 3869684, 939439, 3169584, 7565332, 2961999, 6922700, 5849097, 1236965, 7955660, 4434054, 2494940, 7003416, 2696594, 5078515, 5953893, 4474970, 784461, 6682941, 7135053, 5425932, 4107496, 3210839, 7056292, 5364284, 3273366, 7095712, 7246895, 7176537, 3229219, 162785, 1041686, 2086731, 4838355, 2992636, 5889490, 7545101, 7680538, 8041062, 3756706, 4003760, 7940583, 7601155, 1372360, 3861168, 1728497, 4957588, 5579686, 503975, 3878250, 5919632, 2939794, 6748859, 5463971, 7458335, 3138367, 4936543, 2115274, 7131388, 187430, 7626149, 6046951, 4494826, 7269467, 7483465, 7711173, 5049867, 2237043, 6822243, 3028353, 7808018, 5074040, 5800159, 495364, 2776492, 7822058, 5615521, 1639275, 3092716, 5248801, 3795140, 7197260, 3273238, 467152, 5149496, 6875169, 3625803, 351640, 6674616, 691968, 3909443, 2202280, 944610, 7428703, 7827541, 3192084, 5331461, 1491448, 2857924, 105134, 4065874, 4320652, 646422, 6132382, 1979927, 7323581],
          [5505730, 5081777, 1154324, 3359492, 2136033, 5811722, 6464555, 5532679, 5255854, 783334, 2372153, 2569544, 209770, 165266, 1018254, 2168445, 8340069, 4463935, 7201954, 4161015, 3143817, 6403283, 6975113, 576940, 3027430, 3006417, 816115, 3734858, 2613562, 762303, 554155, 3066196, 5981611, 6827203, 6837598, 1448882, 5286684, 550692, 5680757, 4526982, 1769715, 6700691, 8268799, 4066085, 2439348, 1750146, 2539474, 799905, 3802460, 4746991, 5294447, 6819490, 3737950, 1316867, 506961, 642928, 3725515, 3112754, 3432354, 2817145, 897625, 1628809, 5817903, 7407308, 2726963, 4435217, 3144910, 6675626, 7823713, 2709096, 6293738, 5515717, 7753917, 2607789, 4220205, 5892185, 510771, 4109486, 1926104, 1083099, 1026213, 3937894, 1601895, 3221150, 818369, 3923865, 2507886, 2364868, 6408286, 8278072, 5991813, 1013199, 1601348, 7555890, 6302285, 1632070, 3666710, 3666571, 1998091, 184873, 7107816, 6209055, 7818746, 6836066, 5080961, 6289079, 3758289, 3328810, 2469139, 6535043, 5798757, 1598472, 6440732, 6717075, 1484260, 2096565, 2224980, 5817845, 1962961, 4992711, 6570467, 4535334, 2402021, 5116626, 6639765, 2270962, 6884806, 3365875, 7386503, 3391841, 6962711, 8238346, 5304595, 2740678, 5787943, 3661179, 7317485, 5634078, 2669012, 5703550, 196266, 6343224, 665217, 7462507, 3462026, 386, 5962725, 1842887, 3806848, 3136664, 951496, 3164973, 4914843, 5181147, 595737, 1883845, 2402754, 7835837, 5551655, 5894497, 1266582, 7935306, 477493, 4114192, 1110850, 880146, 5549937, 2832273, 2893390, 6151636, 2179111, 3420462, 4730480, 7107663, 1433996, 4999630, 6486364, 1857161, 4137814, 7122690, 3971969, 3055106, 6094336, 8290333, 1152576, 3779761, 4098180, 7067903, 6321458, 7995421, 7729971, 2752070, 7661707, 5208185, 6867553, 6044576, 4492715, 5032990, 442294, 1850840, 5232984, 597218, 1520981, 6186238, 4279828, 5119956, 8089040, 3442108, 6841202, 3062649, 1537886, 4554287, 3516459, 6607016, 2163239, 4001363, 5490546, 6749468, 4396432, 1053778, 2523324, 86548, 5667166, 567081, 4131148, 6723686, 2671524, 8376296, 113958, 1322126, 5032161, 6491737, 2824954, 4385796, 5810742, 4570199, 277494, 580616, 5796834, 5143361, 864596, 4366622, 5481190, 5691347, 3747285, 3558226, 7818478, 4242222, 4650503, 8349152, 3080516, 2658601, 2914765, 4421077, 7658837, 5982023],
          [2700285, 1771391, 70141, 960449, 739737, 5286950, 3577124, 5321992, 6267931, 4110607, 3535013, 3563271, 2144452, 267919, 1546436, 4903333, 5777620, 3911303, 2459837, 2184892, 7334868, 7809124, 7842019, 777724, 3157801, 315856, 7760659, 6432797, 2868734, 253610, 837502, 5083192, 3338676, 5450472, 3530254, 4204698, 995669, 3966566, 1556417, 4958068, 2266554, 6063078, 5343257, 7955584, 1543891, 6535841, 6796344, 6334367, 6255754, 2775121, 7240370, 2406399, 8295220, 1807524, 3905878, 7214528, 1130683, 1676818, 243071, 1651365, 2460995, 5109823, 7219244, 671673, 1842966, 6797630, 6628788, 5181829, 1643168, 4024831, 6509224, 2507069, 7358689, 4184246, 665645, 5984490, 3374497, 5657947, 1558063, 5198324, 6219831, 6335243, 4762935, 1930771, 3694100, 5121830, 3222003, 7654483, 8035727, 2681282, 7354658, 7137627, 6865249, 4759931, 3691947, 330764, 299076, 1192482, 4052633, 8140476, 7396218, 4353409, 6990735, 7193167, 2798232, 8182587, 550640, 6562798, 3961846, 7528080, 6843844, 746443, 2423348, 5588775, 5454199, 7390535, 5193077, 257795, 2694763, 5846427, 7753515, 5884111, 3437277, 7971357, 2404713, 8093495, 2019795, 6881067, 268605, 181376, 1914818, 7389734, 4478125, 4703272, 4939390, 202222, 3250289, 1850022, 644434, 1097254, 6426345, 1904833, 2246637, 7330083, 1798380, 6771765, 2111399, 749303, 3716217, 1591055, 3919039, 2904822, 2379397, 2946652, 3369068, 8053315, 2827568, 5377456, 1762880, 416025, 6513465, 3158692, 4633276, 6823767, 5017043, 6163355, 4736462, 4682766, 5256909, 4380998, 688727, 1304266, 5656699, 3576689, 5232012, 1521365, 2176369, 1204196, 5774258, 5099518, 1630069, 709550, 5084909, 4989605, 2919910, 7261028, 3946154, 6550445, 7078062, 4892203, 1803189, 1328038, 5650474, 4187832, 6654315, 4611399, 2590749, 493160, 4815, 4814638, 2096239, 1601133, 4294568, 576265, 3413587, 7303650, 303119, 4051300, 870962, 1839631, 7434125, 4527000, 3843849, 1907756, 7647301, 4467451, 3825770, 6038872, 7823098, 2300583, 600342, 563590, 1598660, 2434856, 5055974, 4027952, 2544761, 6782518, 5183494, 3640194, 3993124, 3693417, 6603028, 8322252, 75728, 6053969, 1024499, 2399157, 3204622, 5130404, 6621683, 6380970, 5095987, 1755407, 1179974, 5598854, 2254677, 1040829, 771860, 5827271, 1999401, 4634903, 7912816, 3673322, 6302759, 7664385],
          [4532955, 2671839, 6162896, 5512304, 4697774, 4253736, 1145313, 1654468, 7813035, 4800914, 1626654, 6745097, 7051281, 4175333, 8241076, 2969136, 947915, 8101318, 5802788, 4539205, 2427732, 3275967, 7800812, 5816363, 5986573, 2110377, 7855890, 4742168, 5717738, 1994057, 5825591, 5341074, 3771274, 2047543, 7637552, 3999627, 6162053, 2544797, 536117, 2979377, 4249483, 2109515, 6760359, 6013399, 4466681, 5659041, 5181676, 5295934, 3673743, 2744712, 4711994, 7594744, 872279, 327230, 2360402, 2627887, 4001563, 1675181, 7027977, 34127, 668297, 7406345, 6832654, 198561, 641191, 8302156, 6883909, 4174557, 1606969, 7271156, 1843765, 7632561, 1508379, 365010, 123252, 2844634, 5509859, 7161715, 2148623, 897137, 2544527, 2517202, 3970431, 6008601, 45075, 4545277, 4517439, 91011, 7506105, 7755985, 5705487, 3626226, 5156052, 4694538, 7447744, 4341356, 5787353, 5124670, 5758983, 3447005, 2311126, 221250, 5637, 4839838, 4189994, 3435137, 7520783, 6823218, 7531560, 1713005, 7831387, 4453513, 1844167, 2668484, 1810325, 2940345, 5935910, 3391716, 3204999, 7973207, 1622187, 5473487, 3324401, 2641132, 6925397, 6333755, 2286490, 546282, 4316909, 3251734, 4898384, 4737530, 7135392, 7857594, 1005838, 5013774, 4089478, 1161020, 2566181, 881341, 4079980, 6100157, 7830419, 4935899, 7265942, 2496119, 4400610, 7743234, 5579911, 1806574, 660854, 507570, 834315, 8244883, 921030, 4766613, 6600587, 4357285, 7889080, 2503900, 7417421, 2307359, 1142072, 3496344, 1524324, 5924778, 1194234, 406057, 5122879, 1547389, 7947315, 1946152, 2775946, 3680491, 7992893, 6212633, 1650762, 3902510, 761480, 4165494, 7358423, 4486360, 1270514, 381019, 7289032, 7567140, 2306142, 6299443, 8004224, 6741603, 3540644, 5296566, 5735015, 7572572, 371460, 6577896, 7176543, 9102, 7421631, 4475071, 756870, 6601777, 8134760, 2108163, 985547, 7182266, 2740795, 3407823, 3935664, 2416104, 1742240, 3384142, 2597880, 1483089, 4745416, 7220847, 7340780, 124219, 7547485, 6969964, 7601370, 4803876, 6294743, 1690186, 3098579, 5702814, 2258733, 795512, 2188772, 165285, 6483335, 1404065, 1374120, 118775, 1667231, 7857189, 5601181, 5112391, 5909246, 4629785, 1964096, 8123237, 3123583, 728611, 4477736, 4729836, 5878837, 3200640, 4539912, 5927373, 4997410, 6522125, 5462625, 7560729, 7282902, 2095389]
        ]),
        mockPolyVec([
          [290074, 4887289, 2753912, 3613906, 5078139, 856349, 4876448, 2625614, 3150457, 2002377, 3546004, 2982749, 7612920, 3205185, 1840925, 7706738, 745602, 3808699, 4654400, 7615623, 5127894, 3397944, 3650907, 5372169, 1103579, 4936844, 5687274, 5580540, 5382991, 8003603, 936018, 3169457, 5972910, 1995077, 3288869, 3996702, 4856769, 1929440, 6089981, 765606, 1801220, 2892713, 8225448, 6462005, 2902599, 8245180, 1192185, 7851928, 2384909, 2251896, 3368858, 2431119, 7265420, 3942873, 2940639, 7663497, 2934683, 3196, 7113693, 3991155, 4240263, 3415391, 3342014, 4519034, 4913234, 312416, 3979891, 2275546, 6005493, 3405713, 5604819, 80836, 4219910, 5721374, 3359373, 1104561, 6269811, 2425750, 5502542, 1879871, 4322777, 7414676, 4380054, 2710423, 4934138, 4382798, 7818534, 6874678, 3485251, 2377474, 8172767, 3113896, 5598748, 4416205, 739266, 2991041, 7222255, 141386, 5362862, 1038391, 3848406, 6460167, 691560, 1603178, 6630364, 7737540, 8281624, 3140325, 7369947, 2351509, 2796763, 5918089, 5181790, 915820, 2068347, 5715494, 7486699, 1661633, 5297525, 754413, 5728433, 6107445, 5487012, 1039208, 308947, 2436778, 7135871, 6609791, 5939973, 1030954, 2260298, 4076346, 3495429, 2440532, 4954827, 7383025, 6920709, 1675395, 7524123, 6500082, 7858486, 2549588, 7887484, 2640267, 8216264, 5987589, 6747935, 9151, 7047115, 1224473, 742974, 6445007, 173130, 2912293, 4996645, 899939, 4899082, 2461588, 6274841, 4156697, 1938505, 5124346, 4952794, 6470697, 6958793, 1709844, 872276, 7722109, 675219, 1807215, 5450279, 4184275, 3028517, 2102307, 6724402, 504913, 5392918, 1229722, 525084, 2122092, 2682290, 3950408, 442654, 3861145, 7752476, 6980036, 1218695, 5014719, 4015024, 451077, 6588562, 3630142, 1478197, 3992034, 7275098, 6721855, 3747242, 7771013, 4907524, 7677479, 5438887, 8098993, 1373785, 4797076, 5211719, 1256493, 7933136, 1555802, 7575240, 8190302, 5492129, 6933094, 6567578, 8195308, 810234, 405601, 7238516, 1097956, 8275885, 6922829, 7586217, 1896279, 5110596, 6601267, 4313156, 6416394, 7177532, 8325129, 951542, 857770, 2213007, 2110119, 7981547, 1748457, 2228250, 6231888, 6694251, 1537141, 4772344, 243587, 948839, 4235070, 5516567, 4956789, 582871, 193852, 1218732, 1973303, 7648767, 4501027, 5902027, 1134010, 1717754, 5395539, 1106727, 7790735],
          [4311476, 6158145, 4089515, 8286454, 6263355, 109181, 3403450, 5171350, 6110908, 1885104, 6867001, 4451604, 2714583, 8017382, 1953417, 7639223, 6109447, 525473, 3879824, 793452, 416497, 4695548, 2403786, 1629983, 2609126, 3535474, 3470907, 7025200, 2159368, 2465952, 2319125, 4632650, 6338014, 3739376, 2230840, 2137040, 816283, 573463, 6803168, 154820, 8364410, 4381482, 7030253, 8210763, 1860951, 5391694, 3057601, 3720635, 3473022, 7467757, 8023826, 909281, 1365508, 4835590, 5482412, 6133804, 5716554, 4247722, 6634959, 7046820, 3191903, 3028340, 2503690, 4848807, 6703862, 3213100, 2800590, 7942481, 3779659, 4273018, 32479, 11559, 3317455, 7394655, 8240876, 3488325, 7238544, 5887209, 6200455, 5347081, 5279751, 702983, 1636534, 6430263, 4914101, 4087378, 5153801, 5338126, 2310025, 5741858, 6542737, 6248457, 7505684, 5958097, 6603688, 6566376, 844992, 1859220, 1539105, 7621710, 3098031, 3532478, 2732523, 4732053, 2146352, 8010918, 2466070, 2595153, 7575065, 3651274, 1089771, 6740499, 3296679, 4433141, 2716291, 6166811, 2301327, 2916260, 7907530, 3483292, 2979239, 4790980, 6879434, 1583677, 2087776, 5097586, 1673033, 3196268, 6498156, 2926175, 2765816, 4736486, 1796962, 7080686, 4608995, 6214553, 2194271, 5343971, 1974454, 5387858, 6592077, 2324977, 2190296, 4219548, 5970423, 8058729, 3716027, 6750334, 2314559, 3168277, 6690617, 7823762, 6114107, 1979165, 7750092, 2371104, 494460, 7651079, 7265831, 2843584, 3334681, 4736098, 3157763, 5041257, 5582368, 4831244, 4588313, 6808731, 2014341, 93967, 2008150, 1507449, 796942, 127361, 706731, 6791660, 1662782, 5671990, 4264454, 7081251, 5383725, 631986, 7479761, 5857, 8122350, 8202823, 3576817, 7433993, 1055451, 3140304, 3990848, 110676, 2714765, 4619503, 5292349, 7661198, 1043368, 7272043, 3011753, 164598, 473786, 6453316, 3655839, 1122451, 3725312, 5878939, 8201193, 7542015, 5622866, 3128250, 2203147, 5640669, 4515266, 7973231, 6871596, 2840927, 5053529, 5454281, 7391283, 1395659, 1780358, 4365603, 5392944, 2067166, 7824291, 815162, 2167246, 7654016, 3651697, 936964, 2808143, 7657224, 8298747, 1545796, 3177019, 4407318, 1082371, 64044, 4061138, 1055439, 6787834, 2137214, 4636426, 7232125, 7355747, 8315757, 7446486, 5810236, 4349036, 917392, 1713151, 4609391, 3786510, 7946569, 6383340, 5124289],
          [7397454, 2516413, 3924441, 8261172, 8368941, 588717, 1562908, 5045178, 4362964, 8113759, 7168150, 5074248, 4136174, 1366902, 4513559, 2680492, 4232249, 1915984, 2307759, 3792873, 2648055, 3479262, 406814, 4596573, 5079449, 3126830, 1020473, 2944576, 2535154, 1249167, 4724283, 8136570, 5285273, 6728130, 3351905, 1100499, 898738, 6165261, 4035934, 427369, 267480, 6691452, 724574, 5879626, 1613343, 1974078, 3910024, 7548688, 7471949, 6493172, 6711363, 2634177, 6425232, 1066810, 4470539, 2886876, 3986490, 6008723, 2400105, 2861357, 3754474, 2733314, 6218653, 7367743, 1962195, 7936600, 7884888, 4237342, 4452916, 646472, 5732365, 3095153, 4691035, 4225886, 4730354, 7454300, 2569844, 3424859, 7363998, 4804214, 4578061, 593385, 7791200, 8288340, 3046985, 2389170, 4562533, 3718586, 6798310, 1246854, 4541230, 7437532, 5494823, 1588240, 1550524, 1131534, 3610897, 3171220, 944691, 6370090, 2891369, 2726483, 5957927, 3682236, 417986, 729802, 1734974, 1691042, 4071837, 1523406, 3888001, 6198043, 3053409, 3592358, 4669662, 114122, 1512195, 282148, 7495956, 225898, 8101210, 5557563, 7029291, 1086149, 3087087, 101003, 5807799, 5152352, 7254109, 1879954, 2392933, 5721368, 5043290, 8250354, 1240584, 5398669, 7605410, 1847221, 313147, 3205278, 5488357, 644767, 2438576, 6727396, 2366833, 5895804, 4577658, 1305917, 5130904, 3932457, 4938024, 7042572, 4774951, 6655581, 7445376, 4396097, 2815490, 2291687, 506017, 616584, 5329052, 7105791, 70718, 3569654, 7065052, 2093462, 7375972, 5147317, 4192078, 6007723, 4871856, 7272520, 1662978, 1205936, 1982074, 586986, 1365708, 5597685, 2242912, 4102392, 7687460, 3729347, 315530, 4938472, 5554042, 7997104, 1031999, 4225558, 3645070, 4887022, 7919138, 1052742, 3428644, 977318, 5603640, 7059682, 1665236, 1291446, 5771503, 3882595, 5173442, 322455, 3054567, 6818783, 5418786, 7666962, 5216943, 935897, 4598896, 3347164, 2499650, 5359835, 4343145, 1919701, 751282, 7972216, 860556, 6974686, 2783675, 1867474, 7859659, 7873346, 7211792, 4837217, 6913967, 348555, 2785415, 7884777, 5562264, 3958058, 8271959, 6610203, 957775, 4573686, 2060657, 4245727, 2071408, 5597463, 5535839, 2229701, 7631399, 4790895, 4318304, 7245287, 1760427, 36342, 2182890, 3493991, 1403844, 4770786, 5784026, 3509487, 4085976, 2103425, 6951284, 7353009],
          [7461476, 8124108, 985410, 3896047, 1194312, 4376664, 4779909, 1544104, 3317696, 5209589, 7172024, 5181343, 1596998, 5564662, 2361041, 22241, 4690520, 5860849, 822030, 3712647, 5319200, 2978965, 6261512, 1877119, 810121, 243758, 7097626, 5464955, 1684764, 4548211, 2685455, 2409345, 8365668, 3823000, 4223316, 7316880, 2557611, 485049, 674157, 4171337, 6785805, 1904488, 4130488, 4102367, 8008872, 7485965, 6468225, 1917562, 7160993, 2831539, 6590168, 6219547, 6146355, 8267587, 51274, 3789821, 7620494, 2900512, 3506622, 7821080, 758121, 194048, 1122194, 3332452, 1438344, 4137555, 3633010, 992755, 647360, 2212662, 5855664, 4184842, 7909240, 5907021, 5620731, 5651826, 5390370, 6757026, 3699024, 1710258, 7717626, 939685, 6081422, 8005471, 3146443, 2414862, 3464101, 5628760, 5203421, 7326579, 5659480, 3069330, 2485116, 3907684, 2338162, 1673061, 902667, 3017122, 1180823, 3167879, 4643652, 2703476, 3951291, 3006039, 2646559, 5723022, 6385517, 5058511, 7209705, 8127894, 2043313, 2896191, 6203476, 3920421, 4610261, 7865910, 7541796, 4278723, 4222399, 7855725, 7508511, 6702769, 3343706, 7941407, 7037423, 1704137, 5351559, 1702889, 1160341, 4777193, 6321287, 5040554, 1324797, 2852515, 2342162, 4094083, 6268593, 318026, 5636002, 2176242, 3646004, 7526368, 4206169, 1384434, 627606, 7490460, 2856418, 4226478, 1880363, 6298927, 6483949, 7576079, 3876797, 1076580, 6912989, 1736981, 5729943, 3887377, 2140124, 6701399, 6821020, 7215458, 7046249, 5255669, 5145087, 2468905, 3422448, 431667, 6511998, 4106623, 6414988, 8314391, 3173488, 3017701, 5130467, 3121620, 7900913, 4305211, 5586785, 7742865, 7381792, 3693021, 1859919, 4942251, 940808, 1989775, 5089827, 4050360, 6083857, 6273818, 5303961, 1630998, 5328827, 576509, 5421125, 4797633, 3320317, 7290644, 1450035, 6186054, 4842949, 1954311, 7711920, 7961267, 3919970, 6939724, 6056787, 6556052, 8251203, 870023, 4270638, 8369259, 4275756, 700644, 2376299, 835527, 8191984, 7281597, 4447275, 1644770, 2770312, 4517706, 386656, 3033160, 4256470, 8189687, 2655465, 7363116, 7494086, 2183839, 3618896, 6222209, 7664123, 2047623, 14103, 2458615, 3035870, 1075051, 4768934, 5246111, 4187401, 2298116, 236049, 5806868, 6513040, 6476846, 1389192, 868273, 5719609, 6426857, 7047235, 8089300, 3875378, 6835367, 7016518, 6203359]
        ]),
        mockPolyVec([
          [1758384, 655721, 3611419, 2297584, 4396069, 4343848, 6108823, 3755852, 5742411, 1792915, 417359, 7284350, 3043783, 7589117, 1657687, 331915, 1084746, 6470436, 6783348, 3603423, 7449574, 1133374, 510153, 4158198, 873417, 4004610, 2793505, 6598970, 5915540, 8028633, 910526, 490481, 2794570, 5612533, 1199956, 8272010, 6173412, 7686638, 6320441, 1298964, 2885675, 2591698, 7228081, 4778286, 484934, 4110476, 3215267, 7148455, 4896155, 6712384, 8239340, 6506931, 7079803, 7814060, 6590247, 4139352, 4390601, 5528553, 5961880, 162953, 419081, 2249894, 2888325, 1553204, 5270877, 1538997, 5791587, 8030414, 6316501, 2728600, 8112255, 1082010, 6601050, 3531412, 4633376, 1236803, 6128856, 5564955, 5064710, 4263158, 4909894, 365515, 3094059, 6556520, 3130419, 915289, 2598603, 1717775, 4050092, 7958600, 4257702, 1776971, 8341585, 5551425, 7859105, 6270705, 8188693, 6609353, 3206094, 3987599, 5047732, 2560281, 2386334, 2231249, 7212592, 2565803, 4539412, 5090299, 3858628, 2430307, 8361691, 7950792, 4118126, 5634129, 4950837, 2955197, 7558602, 5759248, 8091988, 5371713, 2754217, 3560556, 5165181, 7742518, 7248252, 4521106, 5601393, 932786, 585973, 7557746, 2772631, 7948614, 5011135, 3743110, 5160607, 7806359, 1435681, 3063145, 671896, 2920555, 1060606, 4844000, 6946915, 1388460, 1057178, 7524127, 1473338, 7539249, 2936771, 8151514, 6638794, 6457125, 8220126, 5694841, 2147414, 3215407, 2636261, 159271, 1083431, 2134669, 7557402, 2236651, 6307298, 8110772, 4114617, 687989, 2732482, 40774, 8001704, 2288995, 1859428, 1080754, 4445083, 4781487, 732879, 4041163, 5137056, 6616660, 3559193, 868867, 3157220, 573456, 3550020, 3802779, 4343926, 343670, 3934837, 2113228, 132294, 1554455, 159850, 1219668, 3118932, 4906727, 6153044, 7729734, 274300, 3540985, 6809948, 2591946, 3487827, 6536662, 6705971, 6999808, 7037649, 751489, 8074522, 1640131, 7202057, 1045633, 5930142, 1847961, 2839724, 1673962, 6164500, 3632960, 2670532, 3870876, 2258192, 7809349, 59535, 587291, 7012000, 8323947, 3457783, 7795978, 1299945, 5362091, 3252927, 2643475, 7582091, 8158152, 7597830, 2148921, 5671884, 1621984, 130383, 3366957, 2985147, 3845664, 5415036, 2466381, 6746562, 756444, 7075406, 1397920, 7469260, 5815440, 7575679, 301514, 8274985, 6805487, 5865672, 3603855, 780289, 3052074],
          [40414, 4527912, 2816915, 6262587, 6791202, 7160106, 3935292, 1019683, 1160651, 5649676, 3550025, 7029959, 1774021, 1188516, 3885266, 5516949, 1882181, 4441348, 3334035, 6550834, 7031799, 3248428, 5217248, 2618090, 2197140, 5658029, 5253969, 1179258, 7341457, 5788527, 2888891, 5960606, 5137622, 21530, 827900, 214162, 7483049, 7888027, 3873253, 7232312, 3036092, 2369940, 4674203, 948871, 340256, 6197, 1187556, 2756235, 2537597, 7693298, 6206026, 6311982, 2897085, 208453, 1827127, 6131034, 5827178, 2872441, 2860355, 3891919, 6802843, 900957, 1087572, 1882199, 7801999, 7141441, 4601354, 1078802, 5168959, 5369019, 6742067, 7039674, 874444, 4684801, 2679002, 3974867, 3253684, 2971695, 2808860, 3578132, 1604777, 2920549, 5063385, 3879173, 176141, 7491306, 3241981, 7625779, 5201259, 3388329, 4872258, 5219097, 3792270, 7391926, 1189043, 3702809, 8154162, 8192939, 3031430, 612035, 2521539, 5129712, 2592846, 79595, 2132134, 4296077, 6628146, 3806320, 6127378, 5664890, 4832968, 6637433, 4745328, 4524935, 1184452, 5072617, 39772, 1142985, 6834514, 5417298, 1362523, 2674928, 4540220, 5641111, 1402349, 6494112, 3397886, 6994262, 6143273, 3905375, 6468835, 6865241, 3896477, 6203246, 6038464, 140059, 1402277, 473898, 4590326, 4718014, 513420, 8078842, 1206396, 6846384, 3534816, 6010244, 7846691, 4637901, 2428993, 5723104, 2092357, 6696704, 5028893, 6804261, 6676174, 5322304, 2231819, 7466363, 7958245, 623879, 6168807, 3331557, 482444, 1765599, 7054836, 927679, 951121, 7883200, 5716679, 169727, 7914671, 3031055, 2393397, 1362963, 1948259, 5497797, 6969377, 1836764, 3046276, 7146329, 5276400, 2737571, 4878879, 370175, 2889791, 3719572, 6665461, 815944, 7643953, 5304804, 5168416, 574502, 6639361, 3810576, 188537, 12416, 7819810, 5528678, 3416232, 4330370, 4320628, 7423163, 6859135, 601106, 4916140, 2953429, 962188, 7807289, 8353482, 3224968, 874507, 7648545, 3078479, 1103097, 599776, 1327982, 720587, 3159964, 4208244, 1007896, 5570131, 6013594, 3974889, 2663948, 3759358, 684276, 3180232, 2398573, 4538280, 2377290, 2465836, 7139105, 5516625, 2088862, 3416939, 350056, 6978657, 3520762, 8247148, 562991, 3345897, 6246619, 7083997, 8326621, 6329904, 3611688, 3632848, 7980912, 7392597, 2784217, 1289487, 8329584, 6021237, 1012168, 6460525, 3175052],
          [1809100, 6727008, 2622326, 1526633, 8202186, 3487380, 3754733, 1910533, 1671962, 4292756, 5903280, 6670748, 7852499, 5671814, 7649675, 2198742, 2788483, 1170211, 2544335, 4826198, 3237954, 1636244, 2022021, 7767795, 3205416, 7644592, 1417366, 2641436, 7514740, 2931204, 4145756, 5459816, 2097681, 3757091, 5773912, 1353777, 2607990, 3082734, 4185881, 7488756, 308346, 5916013, 1162629, 1254240, 1052575, 3786658, 3637265, 258046, 1292634, 4333980, 5776108, 204591, 4648310, 551543, 7908125, 7164378, 8009362, 7420930, 1229555, 5985459, 5571885, 5957816, 3047296, 2547423, 5363699, 1944863, 7420908, 1556203, 3590537, 7037973, 6389067, 3571546, 1509772, 3421188, 1453224, 5768871, 5112899, 1090826, 2493396, 5607025, 3219159, 5770486, 3255632, 2500278, 2555724, 7530826, 1082548, 4090858, 6366560, 4762278, 5598616, 3300321, 537408, 5763296, 5561697, 3297614, 459054, 4651700, 8322492, 6620826, 7456728, 3418984, 2841739, 6214195, 7784193, 4248821, 6750678, 899012, 6247109, 1477504, 6035987, 3487960, 532399, 7685098, 8103542, 4928484, 4132539, 3513655, 731410, 3392424, 2521572, 6970855, 7500145, 7761303, 1261294, 2334263, 3781153, 1937076, 2196404, 3701479, 6839554, 7867543, 6453218, 2563152, 6431111, 6884613, 2977967, 5615479, 7324077, 5380100, 7411558, 1234997, 7328384, 6420107, 3438621, 7060199, 2809427, 4275322, 1268771, 353100, 5490544, 1867353, 2362846, 5588628, 2531652, 5541348, 2279299, 7294282, 1955555, 4763635, 7941663, 5777799, 7148778, 8140505, 1714509, 1592991, 2547844, 3915713, 6841950, 3680664, 2068588, 1798282, 799573, 2778756, 5382003, 7275611, 5759614, 246721, 3288715, 1458520, 6938355, 5383938, 4856399, 4615887, 5721741, 6818192, 391556, 3532274, 737943, 3826702, 7950041, 7650896, 4577020, 5202691, 2763345, 1806122, 4902561, 4538457, 1646759, 1898006, 1877302, 1036813, 6446110, 1200516, 1992061, 4409867, 8018337, 6292950, 4950660, 7005237, 3493675, 6613094, 5009435, 8219231, 3761458, 6529924, 88234, 5040531, 7880784, 4130863, 5593342, 8166552, 159691, 5714729, 4833373, 3981647, 1429701, 8240590, 7211018, 1597640, 3549396, 585710, 5963513, 296780, 2312868, 8171038, 2202471, 8248230, 7799995, 5798290, 4968047, 3959014, 8071215, 6691396, 1881845, 104815, 7606682, 579785, 4151694, 4811463, 2921736, 6720049, 6719069, 5978701, 2414152, 7123823],
          [207509, 8268823, 516842, 7117372, 3664011, 2260830, 5602118, 5043632, 4797921, 6903870, 6318142, 3778654, 7008907, 5022386, 8361506, 7090551, 5208573, 2512502, 7236823, 144243, 4635618, 1414937, 4099534, 504136, 6261076, 2116688, 2262953, 1721557, 8298908, 355426, 8352763, 2047313, 373689, 1393130, 4998985, 572145, 7439668, 4189919, 1833329, 7196739, 6727072, 5771041, 3323379, 8167440, 612454, 539696, 1744625, 1145306, 7064578, 8351991, 1409605, 2207958, 8314275, 5706674, 2859323, 5520393, 1893985, 7433001, 3016307, 1737215, 2502438, 3934186, 3124272, 4745143, 1200544, 7013106, 2095600, 7517261, 4451361, 7197634, 6424420, 4788672, 3639590, 2897904, 754162, 4778445, 7656186, 7864824, 6972128, 7512005, 3283675, 5580781, 1918712, 5878990, 7081954, 5050326, 8185770, 3274249, 2365973, 3693607, 835438, 8255191, 1019478, 622431, 6298162, 8111136, 5515729, 4989689, 3373382, 2612640, 770849, 4387447, 8037182, 459320, 4800246, 5974701, 6542236, 4908813, 339010, 2093907, 6487108, 6516530, 4899436, 679577, 4612763, 2587627, 2938233, 119652, 5539725, 1298173, 4555405, 1462165, 1328176, 5359622, 5692666, 6473055, 6155094, 1418410, 2660734, 780374, 5046723, 5871443, 937600, 6419344, 5585469, 1480316, 2721270, 5459588, 5428816, 4159785, 45673, 4957022, 500460, 3811671, 6997801, 6954211, 1758288, 6039452, 7515249, 7745138, 1352394, 5424442, 3950317, 1217951, 4714775, 6407495, 1690213, 7036843, 2788282, 5216861, 6310212, 1588776, 6005677, 1757825, 7765941, 6575903, 2663955, 6092787, 4770595, 5745432, 7556885, 717342, 4043904, 4977219, 5777923, 497179, 1282107, 670254, 6748263, 6560642, 6047217, 7827649, 912500, 3373633, 7056003, 7821806, 5691633, 4461435, 7388729, 1849848, 474057, 2121294, 4771443, 5850847, 2664971, 4637903, 4046610, 5003786, 387062, 2928774, 5991217, 7469008, 4363456, 6905074, 1031856, 2211944, 2578206, 7831192, 3271722, 3183341, 3415783, 6957169, 5535092, 4286829, 4610473, 1825465, 814889, 8328867, 1767623, 3058972, 3466545, 6338260, 4116741, 1069824, 1114958, 7045073, 3827271, 1636482, 7480128, 5264208, 8148377, 2768962, 2665906, 7870962, 5771779, 3334217, 7548597, 318462, 7622961, 96555, 4334888, 3914714, 5831366, 5552735, 3651846, 15348, 3810579, 8039336, 8030909, 6702951, 6782300, 4876388, 6668644, 4457900, 901038, 2837627]
        ]),
      ];

      final expected = mockPolyVec([
        [-3859659, -6509192, -6820010, 3265052, 2479737, -4009033, 5720235, -4706438, -3495870, 2031513, -7085298, 2837369, 3530408, -1904775, 1134899, -2230702, 1739522, 3614019, -4192886, -730582, -44130, -2666867, -358457, 3768680, -968471, 2149170, -181993, -7240250, -4575223, 3352999, 501330, 1124549, -2471484, 3859352, 3872220, 1477137, -5922972, 1146002, 323199, 2162434, -681399, -5260161, -8335428, 1757515, 7697401, 6128265, -941732, 1498704, 924083, -5214166, -3214525, -1259131, 7239856, -2623707, 6225360, 5962, -4900775, 2063520, -2621248, 1386724, 5347105, -1100173, 8228965, -7141709, 456074, -3303753, 1188483, -912140, -701953, 542562, -1922184, -3778888, -4890568, -7577687, -7039481, -933127, 363312, -7294908, -2045092, 227045, -7075293, 267578, 176087, -3591823, 3492631, 8299604, 5087799, -1812851, -4400511, 2639565, 5876294, -5907161, 2324354, -2288779, -253049, -2257609, -901281, -5023547, 6448258, -1138177, 7881375, 862982, 5663138, 394240, 920853, 248569, -2857348, 5220349, -4525061, -7261003, -4377960, -3025621, 2505198, -2201854, -5313352, -1470921, -2069764, 4294468, 5961688, -1061978, 4595239, 4168493, -5815083, 504066, -2262423, 2289235, -229094, 6246708, 584150, -885879, 1909712, 2392883, 715261, 2069626, -3599124, -641402, 1329637, 4888505, 1929328, 1053036, 4010434, -229824, -1922176, -584858, 867009, 4912016, 741295, 1061361, 1858392, -5708794, 3006666, 7468984, -3220090, -128515, -736206, -5878711, -591707, 4342205, 3776855, -3119777, 7485105, 6120510, -897940, -3462819, -7719920, 7010371, 3445824, 4267635, -7489420, 2278240, -2176558, -473311, -2066426, -508330, 6100222, -8011737, 465422, -3119883, -3402096, 1178594, 4771450, 6402191, 874781, 470915, 5485890, 1888719, 5028460, 5785386, 4570106, -2453676, -3568631, -725388, 328446, 5482027, 2620704, 2288129, 1894819, 427532, 184800, -7039038, 4224842, 748161, -4245938, -7683505, -5361075, -1937474, -646014, -911043, -1596880, 1307606, -4412578, 6542320, 4198528, -1763332, 2394297, -5220867, -1498304, -636501, 3589039, -6939641, -2124459, 3326516, 547532, 53170, 6998033, 4557173, -5683709, 6128526, 1412658, 3841168, 1134296, -5927297, 5985863, 686671, -1416148, 1517792, -365935, 2335959, -2076561, 359541, -1374583, -4967807, 3187001, -175328, -914826, -1390282, 1209210, -2719519, -3303414, -3740001, -2126905, -5345438, 1550540, 1619623, 3725963, 4716003], 
        [-1268204, 3442341, -2453342, 7444498, -2815022, -7111838, 467175, -3707386, -3973726, 5629217, 444403, -2553850, -2605945, 3032874, 4034354, 2479147, -2257343, -1848259, -834140, 564095, -3089290, 3610485, 1950253, -7128802, -1143131, -3192776, -102122, -2520603, -1311032, 75524, 1460025, -3388421, -2395100, 705643, 5936223, -526853, -403551, 3808551, 2037838, 3564365, 1868794, -886976, -351745, -1016655, 623647, 1133252, -3411064, 1886594, 3796718, -5769343, 5371096, 6194591, -93989, -704262, -424063, -4862156, 5953720, -5116876, -4035482, 3022204, -5207727, -5711915, -1500171, -3358068, -908865, 3904169, 5683773, 7879442, -2118519, 2697981, 2718972, 238391, 3098582, -3601206, -2555751, -4377414, 1631311, -6110396, 790725, -2411741, -6763309, -254002, 7326849, -7536319, -2769775, 7119559, -7152428, -996103, -1868410, -2992127, -7986494, 2205335, -1256281, 6210593, -5014746, -4893992, -4564508, 1705537, -2947630, 2820843, -2079110, -4651543, 5074015, 5236850, -1858701, 3902492, 5234741, -1993413, -687625, -1237580, -1637945, 2409430, 2300618, -2779274, -327000, 5048782, 1528005, 2167901, 288386, 272018, -4861509, 4262358, 1193555, -59179, -3451297, -2572084, -631395, 5461954, -3065428, 3487999, -2899155, 3921533, 2125797, 3522728, 2578359, 2233027, 3567544, -4383910, -6498206, 359063, 4192458, -6772285, 4962020, 5271227, -3649259, 7725614, 1928937, 1369004, -1319447, -5178166, -7854110, -65627, 8107000, -4174251, -3575938, -1178073, 995549, 4013004, -2370046, 1868468, -383735, 840849, -4283165, 1692077, -2860961, 2713630, -6714259, -2168997, -992949, -3927383, -3359405, 5348138, -3271775, 4170478, -1093443, -1953496, -5467366, 7473425, -170907, 609044, 1631834, -6796391, 3532354, -4336706, -2075614, -3200310, -4360903, 197211, -4275309, 6289615, -1884812, -1121133, 548159, 331090, 4238291, 522541, 3267245, -3087233, 329737, 1653747, -7039988, 1572708, -683271, -2749289, -1365313, 3180634, 4736896, 5761646, -935361, -7142628, 6823780, 3788370, 2744607, 2659292, 1567237, -4521576, 2412123, 4966337, 4453446, 3359873, 564029, 7648, 243478, 4939465, 7120035, 5232051, -1910733, -3775687, -4556633, -2478577, -534273, 1987660, -2869053, -239218, 573625, -1208742, 420638, 2361195, 7499182, 1171744, 4671469, 3458052, -7288318, 1738171, 461447, 7098534, -2213782, 3873720, -4055281, 7174759, 5437129, -7175712, 751368, -7819538, -388692, -5595805], 
        [-2892252, 4009626, -1011715, 2225989, 1498392, -1628468, 4701437, 2121892, -1149925, -1857569, 1580377, 4593930, -3388992, -1077325, -4458618, -835484, 4665845, -3464017, 3096772, -5880207, 5656057, -7324337, -2605764, 5800496, -1277766, 6285130, -102890, -3374173, -173716, -1490002, 2004243, 7380798, -3913022, -1045683, -3336, 3394363, -2559732, -8355068, 6048565, -4003541, -1893341, -1991103, -6853997, -976995, -817058, 1776220, -1755633, -6840958, -2677334, -3123898, 4746604, -1108709, 182304, 847100, 2550281, -2017304, 2139145, 3396509, -2204603, 7827252, -1274299, -584192, -3759835, -3405137, -5333898, -270497, -1153740, 476745, -6826023, 6120693, 607558, 1333473, -7736067, -2918683, 4113863, 2371247, -5942076, 4849567, 5199570, -232756, 618121, -3325732, -6657089, -493704, 1408695, -327631, -3539731, -1615114, 3273356, 2639463, -690648, 5539168, 2453044, -2799826, 1365651, 2544343, 6910217, 459538, -544220, -6099311, -3498894, 2775461, -6345754, 1327427, -1933099, -4966570, 1574886, 633678, 2410379, -913367, 5425795, -1899975, 6803979, 223920, 1220329, 8275469, -1788489, -3268441, 2103912, -2344982, 2353019, -2029234, 1000849, 5593831, -456497, 2116561, -1606779, -2248402, 3708650, -6934417, -4085233, 2807963, 5709975, 6790931, -4321311, 1292322, 1395252, 4245392, -2440541, 4730535, 1670677, 5753303, -5940025, 1599756, 3426697, -2617590, 1880578, -1375707, 6326719, 933411, 1292863, 376800, 2607994, -4933340, 6708668, 3793941, -1042387, -4571574, -2799475, 1526507, 4787095, -2516556, -4180951, 2635785, -2714411, 870513, 3451049, -2120484, -4480963, -949314, -6424804, -366111, -735586, -2253968, 484190, -1031191, 1496891, -5717143, 771159, 1434810, -2290132, -4329397, 1981902, 6442963, 2512507, 5629935, -3136533, 3074880, -1769148, 3507961, -3478457, -188648, -4012203, 5803081, -2743846, -6344982, -1277313, -1718788, 2580976, 192500, -3715342, -7436013, 4530283, -7609244, -3878184, -701671, 1397171, 1542999, -388956, 7824245, 1626278, -7266655, -2468978, -7338329, -3389262, -1953815, -5285394, 1416373, -728187, 5509438, -5537884, 1107268, -1519100, 3345127, 3220298, -3269989, -7011754, -2814616, -3267887, -888889, -2561204, 1675709, 3481838, 5120149, 6528507, 6097151, 4016355, 3220541, -6690192, -4548065, 4936940, -4222383, 5094966, 490047, -4331113, 6149505, 6116244, 1984115, 838668, -6260687, 813726, -1936326, 8025965, -261086, 1287853, 2122677], 
        [-6181753, 4129930, 4347312, -2228774, -2511274, 7266637, -210834, 5578193, -3869379, -3481783, -6354558, 4516412, 4157185, 847805, 291262, -4989979, -870859, -590470, -2392137, 2034743, 5106820, 1272516, 2525148, 323208, -1837213, 374752, 3959102, -1887120, 2956087, 3945295, -2024918, -1324336, -7912045, 3477862, -4848208, 5891280, 1438357, -3689560, -80987, 3833656, -5207757, -2347159, 2858641, 1947530, -4354433, 2285266, -2158328, 4129518, -7782085, -81615, -5197870, 210063, 7290744, -5607836, 394482, 7172972, -744159, 1684391, 5198525, -7330525, 1974860, 7414219, -3288641, -7413189, -393035, 4419991, -5415420, -230389, -1866535, -1185154, -1490311, -1217166, -1987962, 3044654, 4530464, 1572418, 2945010, 2568992, 782554, -8179439, -3368169, -6319819, 2395583, 2200365, 2597921, -1879831, -3634313, -4412835, -1389079, -656390, -2401269, 2286709, -2730601, 6515095, 2442576, -6358698, -4299806, -2089461, -1604424, -398425, -3531648, 3086422, -5822534, 4230596, 496472, -3164866, -348711, -7151017, 3021986, 3806870, -2273015, -1707943, -4291587, 372850, 3659483, -2371195, 962555, 6169417, 3630939, 556606, 2068723, 1799286, -6390473, 1074496, 4448679, 5052493, -680026, -455103, -1017863, 2409072, 4718178, 2307767, -1370881, -598333, -5309722, 6650868, -4482032, -5486044, 624868, -2313649, 834969, 3802563, -1591036, 6756592, -4477870, 4187405, 244606, 357660, 405018, -384923, 137367, -6547358, -3355156, -1808081, -3509167, -5160350, 3108492, -2193781, -8325697, 3914766, -4338224, -1836070, -4784064, -2891213, 803307, -1937642, -2168166, -3171467, 3405262, 3333733, 6300279, -403195, -3428096, -4520578, -4455437, 1531651, -1594578, -4136787, -3635823, -1417733, 7924724, 801157, -5739484, -3863064, 5054578, 3061591, 2082286, 5163871, 1235264, 1857305, -4467785, 5329706, 1454082, -92143, 227169, 1924216, 1586323, -2425317, -2350923, -2745310, 5369121, 2589620, 2905781, -6097912, -2226414, -3653540, -941124, -1737585, -1319852, 3625935, 255925, 2723222, -3098969, -1029241, -5995463, -2065384, 4194098, 2880723, 3869344, -3620521, -3439110, 3810346, 1869640, -7962313, -3576088, 6188308, 1337120, -898153, -4359382, -1072387, 7209495, -3922713, -742739, -4423124, 425817, 2399474, 1732856, 5499559, -7617705, 2645123, -7886362, 1299347, 1755142, 5085579, 243105, 3029068, 4378497, 910835, 2216, -2256688, 8063727, -2914955, -692051, 2344079, -2451476, -3439114]
      ]);

      final actual = pv.mulMatrixPointwiseMontgomery(M);

      expectPolyVecsAreEqual(expected, actual);
    });

    test('reduce', (){
      List<int> actualCoef = List<int>.generate(Dilithium.N, (index) => index + Dilithium.Q);
      List<int> expectedCoef = List<int>.generate(Dilithium.N, (index) => index);
      final expected = mockPolyVec([expectedCoef]);
      final pv = mockPolyVec([actualCoef]);

      pv.reduce();

      expectPolyVecsAreEqual(expected, pv);
    });

    test('invnttTomont', (){
      List<int> coef = List<int>.generate(Dilithium.N, (index) => index + 1);
      final pv = mockPolyVec([coef]);
      final expected = mockPolyVec([[2555584, -4094004, 445741, 2492145, 162954, -1493646, -2865316, 1966120, 117724, -2156024, 57377, -1401077, 2374870, -661169, 1872253, -767385, -625297, 2884685, 4153317, 1532728, 2384177, 3960789, 731652, -1116420, 753608, -1654232, 2924054, -1173541, -45721, -631616, -1723799, 1878580, -3802464, -4084618, 2749031, 286136, 4002964, -166624, -3493179, -631726, 3400745, -1977111, 1397312, -2299943, 3995664, 2070626, -3852781, -3384455, -2517502, 2457249, 422330, -3295048, 1842693, -3834082, -2178890, -1701355, 2950922, -867524, -143226, -1456024, -2801287, 2729086, -888547, 1486038, 237654, 606622, 1646805, -2150186, -2085699, 3735539, -736528, -3324245, 2607922, 577665, 2713084, 2378349, -3415389, 1474673, -139, 3373477, -3174776, -2535613, -977540, -3381541, -1130192, 3338667, 1666030, 3230146, -3670193, 2391298, 2460446, -3936985, -3041226, -605892, -3550388, 859718, -1050783, 867686, -3490841, -3014890, 2449692, 2479138, 1970172, -1525900, -744625, -1680592, -78330, 144689, 3842724, 2874774, -3910481, 3364246, -3149985, 3141233, 1064407, -2995303, 1836223, -2602407, -2183595, 94329, 1698223, 2516058, 3313587, 1600397, -2224306, 3379734, -2534394, 3982644, 1654208, 3982644, -2534394, 3379734, -2224306, 1600397, 3313587, 2516058, 1698223, 94329, -2183595, -2602407, 1836223, -2995303, 1064407, 3141233, -3149985, 3364246, -3910481, 2874774, 3842724, 144689, -78330, -1680592, -744625, -1525900, 1970172, 2479138, 2449692, -3014890, -3490841, 867686, -1050783, 859718, -3550388, -605892, -3041226, -3936985, 2460446, 2391298, -3670193, 3230146, 1666030, 3338667, -1130192, -3381541, -977540, -2535613, -3174776, 3373477, -139, 1474673, -3415389, 2378349, 2713084, 577665, 2607922, -3324245, -736528, 3735539, -2085699, -2150186, 1646805, 606622, 237654, 1486038, -888547, 2729086, -2801287, -1456024, -143226, -867524, 2950922, -1701355, -2178890, -3834082, 1842693, -3295048, 422330, 2457249, -2517502, -3384455, -3852781, 2070626, 3995664, -2299943, 1397312, -1977111, 3400745, -631726, -3493179, -166624, 4002964, 286136, 2749031, -4084618, -3802464, 1878580, -1723799, -631616, -45721, -1173541, 2924054, -1654232, 753608, -1116420, 731652, 3960789, 2384177, 1532728, 4153317, 2884685, -625297, -767385, 1872253, -661169, 2374870, -1401077, 57377, -2156024, 117724, 1966120, -2865316, -1493646, 162954, 2492145, 445741, -4094004]]);

      pv.invnttTomont();

      expectPolyVecsAreEqual(expected, pv);
    });

    test('caddq', (){
      List<int> expectedCoef = List<int>.generate(Dilithium.N, (index) => index);
      List<int> actualCoef = List<int>.generate(Dilithium.N, (index) => index - Dilithium.Q);
      final expected = mockPolyVec([expectedCoef]);
      final pv = mockPolyVec([actualCoef]);

      pv.caddq();

      expectPolyVecsAreEqual(expected, pv);
    });

    test('powerRound', (){
      final pv = mockPolyVec([[-4135435, -3344473, -3055472, 5167776, -1630539, -9190453, -1567068, -5609240, 2953865, 2303047, -277368, 6846472, -3398746, -7829548, -3111497, -4684041, -11503494, -10540608, -7218827, -14754235, -11250256, -12982310, -6721664, -11071862, -2227214, -6740032, -4352502, -7293644, 3794733, -632975, 379257, -6744463, 5806729, 14045305, -1191916, 5883394, 6906919, 5159485, 1190806, 7436646, 3049741, 1941269, 9037482, 6449592, -842223, -7762487, 1763007, -5633573, -4912329, 2341473, 3884128, 1920696, 4260396, 2377112, 7082801, 5777763, 1361595, -1074011, -5449997, -7494683, 4404458, -3646556, -5222842, -714660, -6282670, -2238258, -6851546, -1813642, 889868, 750598, -8191724, -5746386, -2360042, 5821440, -9277894, -1397772, 4275052, 2324256, 6949029, 12222763, -1462736, -733486, -8938113, -9111949, -1060853, -1277263, -8221007, -4206745, 6722027, 9073249, 1773523, 8296013, -1260527, -4674905, 3789894, 2877790, 3734413, 9726831, 5343398, -482878, 7593110, 4595836, 797414, 6341380, 1604224, 524012, -1906322, 2448170, -5660104, -8181856, -6112055, 1294027, 11614107, 4201231, 7329319, 4679927, 17121567, 10824181, 10785829, 12487311, 2976675, 3178183, 7096501, 9698117, 552129, 1259175, -4219100, -6025808, -380294, 4519604, -5011939, -1612211, -526318, -4914110, 2847473, -20317, 4304310, -248426, 2999210, 768494, -10700439, -5394179, -2604541, -3999293, -10171170, -11292386, -205587, -8498781, -345058, -3232282, -9955966, -5728362, -5511867, -2533773, -11512325, -9975459, 1224235, 6424577, -744902, -6155822, -753286, -6713376, 288143, -1458001, -5660572, 1320940, 1507077, 8689371, -10335717, -2309019, -1031171, 1431219, 3704562, -2023452, -3160528, 4356674, 1775775, 1398849, 13625832, 5643800, -284579, 2229435, 734655, 4602649, 6521345, -770715, 10653089, 7564397, -60353, -3026705, -4663993, 2052807, -4930, 80178, 6604383, -1605599, -3106901, -2373513, 1685083, 3581203, -5029020, -10170234, -7728795, -1230827, -2800132, -2546366, -3336208, -8909090, 1384350, -6676064, -1181982, 4946116, 2332153, -5762859, 617338, 863180, -2892532, -9438784, -6820323, -2821793, -8224215, -3671611, 569879, -1760789, 5398633, 7070759, 975957, 6094575, 4437087, 5927585, 4386302, 1688494, 3689438, 7151762, -1469031, 3578011, -3963670, 1591406, 1893055, 1950421, 2659622, 3219442, 8869343, 3962377, 10773003, 12684925, 6781776, 8304040, 3043756, 3922682, 5490764, 4384118, 234782, -7219700, -391480, 7057846]]);

      final expectedRounded = mockPolyVec([[1525, -2137, 144, -1376, -331, 971, -2396, 2280, -3447, 1095, 1160, -2040, 934, 2004, 1463, 1783, -1926, 2496, -1675, -443, -2640, 2010, 3968, 3722, 1010, 1984, -2550, -2764, 1837, -2191, 2425, -2447, -1399, -3975, -4076, 1538, 1063, -1475, 2966, -1690, 2317, -235, 1706, 2488, 1553, 3529, 1727, 2523, 2871, -1439, 1120, 3768, 556, 1432, -3279, 2403, 1723, -859, -2317, 997, -2838, -1116, 3654, -1956, 594, -1842, -3034, -3210, -3060, -3066, 276, -3794, -746, -3072, 3642, 3060, -1172, -2272, 2213, 299, 3632, 3794, -641, -2445, -4085, 689, 3761, 3943, -3605, -3487, 4051, -2483, 1041, 2727, -3002, 2398, -1139, 2927, 2214, 450, -874, 124, 2790, 772, -1408, -276, 2414, -1238, 568, 1952, -823, -309, -2149, -1265, -2521, 2295, 287, 2549, -3035, 2703, 2979, -313, 2229, -1211, 3265, -2393, -220, 3504, -3462, -2380, 1565, 1613, -2030, 1090, -3343, -3933, 3510, -2666, 938, -1554, -1687, -3843, 515, -1597, 3294, -3810, -787, -3677, -994, 3558, -2686, -2154, 1349, -2445, -2565, 2397, 3627, 2049, 570, -3630, 378, 4064, 1423, 175, 100, 2028, -251, -2341, 2587, 1125, 1021, -2381, 1778, -28, 1584, -1470, -1889, -1983, 2536, -488, 2141, 1211, -2625, -1255, 513, -667, 3489, 3181, -3009, -3857, -2745, -3385, 3262, -1742, 1631, 33, -2133, 2167, -2469, 1299, 868, -3962, -3739, -2027, 1532, 1346, -2064, 3806, -98, 416, -2334, -1852, -2567, -3883, 2938, 3020, -756, -1600, 3613, -3745, 553, -1595, -3561, 491, 105, 1063, 1109, -273, -2977, -3423, 3582, 942, 3038, 146, -2663, -1893, 1258, 2158, 703, 725, -2778, -14, -2593, -2551, 523, 3709, -1200, -2648, -3668, -1286, 2124, 1398, -2786, -2548, 1736, -3658]]);
      final expectedRemaining = mockPolyVec([[-505, -408, -373, 631, -199, -1122, -191, -685, 361, 281, -34, 836, -415, -956, -380, -572, -1404, -1287, -881, -1801, -1373, -1585, -821, -1352, -272, -823, -531, -890, 463, -77, 46, -823, 709, 1715, -145, 718, 843, 630, 145, 908, 372, 237, 1103, 787, -103, -948, 215, -688, -600, 286, 474, 234, 520, 290, 865, 705, 166, -131, -665, -915, 538, -445, -638, -87, -767, -273, -836, -221, 109, 92, -1000, -701, -288, 711, -1133, -171, 522, 284, 848, 1492, -179, -90, -1091, -1112, -129, -156, -1004, -514, 821, 1108, 216, 1013, -154, -571, 463, 351, 456, 1187, 652, -59, 927, 561, 97, 774, 196, 64, -233, 299, -691, -999, -746, 158, 1418, 513, 895, 571, 2090, 1321, 1317, 1524, 363, 388, 866, 1184, 67, 154, -515, -736, -46, 552, -612, -197, -64, -600, 348, -2, 525, -30, 366, 94, -1306, -658, -318, -488, -1242, -1378, -25, -1037, -42, -395, -1215, -699, -673, -309, -1405, -1218, 149, 784, -91, -751, -92, -820, 35, -178, -691, 161, 184, 1061, -1262, -282, -126, 175, 452, -247, -386, 532, 217, 171, 1663, 689, -35, 272, 90, 562, 796, -94, 1300, 923, -7, -369, -569, 251, -1, 10, 806, -196, -379, -290, 206, 437, -614, -1241, -943, -150, -342, -311, -407, -1088, 169, -815, -144, 604, 285, -703, 75, 105, -353, -1152, -833, -344, -1004, -448, 70, -215, 659, 863, 119, 744, 542, 724, 535, 206, 450, 873, -179, 437, -484, 194, 231, 238, 325, 393, 1083, 484, 1315, 1548, 828, 1014, 372, 479, 670, 535, 29, -881, -48, 862]]);

      final actual = pv.powerRound();

      expectPolyVecsAreEqual(expectedRounded, actual[0]);
      expectPolyVecsAreEqual(expectedRemaining, actual[1]);
    });

    test('randomVecGamma1', (){
      Uint8List seed = Uint8List.fromList([0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]);
      int nonce = 0;
      int gamma1 = 1 << 17;
      final expected = mockPolyVec([[121734, -77002, -28253, 106854, -62871, -121308, -68538, -54224, 11297, -127054, 109357, -7942, 122742, 19562, -62460, -82650, 90819, -66916, 91242, -4883, -49610, 8532, 86728, -130101, 96345, 13713, -70746, 44955, 45506, 121371, 53270, -21154, 24769, 53074, -97775, -11701, 40940, 31276, -22093, 73973, 25911, -65782, -31592, -72604, 86543, 2640, 110713, 8481, 55205, 78068, -99948, -25025, 85854, -25267, 8259, -41439, -94066, 30430, 115847, -114741, -77512, -52113, 72773, -99169, -93991, -127982, -58401, 91027, -28150, 69088, -83610, -118815, -64034, -47586, -5831, 111688, 93566, -36350, -94631, -110114, 102331, -16902, -18236, -57123, -8931, 106700, 65, -55728, -84407, 8547, 37317, -129773, 17743, -127339, 67847, 110528, 107810, 16662, -116692, -127373, 14162, -40438, -54183, 120399, 98377, -47082, -72378, -130709, -4991, -45500, -94132, -121854, -13319, 39492, 12800, -4304, 19054, -104257, -55092, 106088, -54188, -25230, -15176, -74877, 20784, 124645, -105025, 12464, 35297, 16537, 44481, 84164, 32720, 30140, 20381, 75174, 20763, -25165, -16841, -43309, 46156, 102544, -90879, 82035, 24183, -73180, 46577, 44248, 91649, 4040, 60233, 44710, -11510, -121510, 47829, 107478, -47472, 70398, -104651, -21807, 72794, -74640, 20435, -74438, 93990, -41611, 37290, 63299, -73981, -121472, 126172, 55504, -125688, -117371, -78066, -106623, 130977, 50480, 56016, -40235, 69932, -32689, 115078, -113435, 38927, 32318, -15921, -69412, -58593, 87654, 51809, 15221, -67292, -2436, 28511, -117592, 110305, 62558, -41556, 121122, -19914, 65060, -63571, 11354, -61336, -50004, 73301, 53397, -26044, -127622, -10898, -108776, -29388, 121634, -109364, 116625, -11905, -2415, 51594, 39900, 79969, -19305, -46595, -10988, 14352, 58956, -123652, 67470, -70996, 81926, 69194, 67938, 26886, -115826, -5095, -48508, 60738, 37361, -43598, -24477, -34320, 109014, 21705, 47886, 38156, 64336, 5305, 103005, -65271, 58050, 18516, 18521, 82797, -39508, 32332, -128345]]);

      final actual = PolyVec.randomVecGamma1(seed, 1, gamma1, nonce);

      expectPolyVecsAreEqual(expected, actual);
    });

    test('decompose', (){
      final pv = mockPolyVec([[-4135435, -3344473, -3055472, 5167776, -1630539, -9190453, -1567068, -5609240, 2953865, 2303047, -277368, 6846472, -3398746, -7829548, -3111497, -4684041, -11503494, -10540608, -7218827, -14754235, -11250256, -12982310, -6721664, -11071862, -2227214, -6740032, -4352502, -7293644, 3794733, -632975, 379257, -6744463, 5806729, 14045305, -1191916, 5883394, 6906919, 5159485, 1190806, 7436646, 3049741, 1941269, 9037482, 6449592, -842223, -7762487, 1763007, -5633573, -4912329, 2341473, 3884128, 1920696, 4260396, 2377112, 7082801, 5777763, 1361595, -1074011, -5449997, -7494683, 4404458, -3646556, -5222842, -714660, -6282670, -2238258, -6851546, -1813642, 889868, 750598, -8191724, -5746386, -2360042, 5821440, -9277894, -1397772, 4275052, 2324256, 6949029, 12222763, -1462736, -733486, -8938113, -9111949, -1060853, -1277263, -8221007, -4206745, 6722027, 9073249, 1773523, 8296013, -1260527, -4674905, 3789894, 2877790, 3734413, 9726831, 5343398, -482878, 7593110, 4595836, 797414, 6341380, 1604224, 524012, -1906322, 2448170, -5660104, -8181856, -6112055, 1294027, 11614107, 4201231, 7329319, 4679927, 17121567, 10824181, 10785829, 12487311, 2976675, 3178183, 7096501, 9698117, 552129, 1259175, -4219100, -6025808, -380294, 4519604, -5011939, -1612211, -526318, -4914110, 2847473, -20317, 4304310, -248426, 2999210, 768494, -10700439, -5394179, -2604541, -3999293, -10171170, -11292386, -205587, -8498781, -345058, -3232282, -9955966, -5728362, -5511867, -2533773, -11512325, -9975459, 1224235, 6424577, -744902, -6155822, -753286, -6713376, 288143, -1458001, -5660572, 1320940, 1507077, 8689371, -10335717, -2309019, -1031171, 1431219, 3704562, -2023452, -3160528, 4356674, 1775775, 1398849, 13625832, 5643800, -284579, 2229435, 734655, 4602649, 6521345, -770715, 10653089, 7564397, -60353, -3026705, -4663993, 2052807, -4930, 80178, 6604383, -1605599, -3106901, -2373513, 1685083, 3581203, -5029020, -10170234, -7728795, -1230827, -2800132, -2546366, -3336208, -8909090, 1384350, -6676064, -1181982, 4946116, 2332153, -5762859, 617338, 863180, -2892532, -9438784, -6820323, -2821793, -8224215, -3671611, 569879, -1760789, 5398633, 7070759, 975957, 6094575, 4437087, 5927585, 4386302, 1688494, 3689438, 7151762, -1469031, 3578011, -3963670, 1591406, 1893055, 1950421, 2659622, 3219442, 8869343, 3962377, 10773003, 12684925, 6781776, 8304040, 3043756, 3922682, 5490764, 4384118, 234782, -7219700, -391480, 7057846]]);
      final expectedRounded = mockPolyVec([[-8325643, -8582233, -8293232, -69984, -8439627, -16523317, -8376156, -8228120, -188791, 207943, -8134008, 37384, -8636506, -8353324, -8349257, -8350473, -16741254, -16825920, -8266379, -16849339, -17011792, -16648742, -8292992, -16833398, -8512526, -8311360, -8542710, -8341196, 128301, -8489615, -144519, -8315791, 45193, -96648, -8524780, 121858, 97831, -78275, 143254, 103782, -92915, -153835, 133289, 164280, -8175087, -8286263, 191679, -8252453, -8578761, 246369, 217696, -174408, 70188, -241768, -250063, 16227, -209733, -8406875, -8592653, -8542235, 214250, -8360540, -8365498, -8571300, -8377774, -8523570, -8422874, -8622730, -157684, 226822, -8191724, -8365266, -8121578, 59904, -16610758, -8206860, 84844, 229152, 139941, 175914, -8271824, -8590126, -16794753, -16968589, -8393717, -8610127, -8221007, -8396953, -87061, 169056, 202195, -84404, -8593391, -8341337, 123462, 258910, 67981, -224914, 105638, -8339518, 260246, -118148, -250138, 56068, 32896, 236, -8191634, -170710, -8278984, -8181856, -8207159, 246475, 91034, 11023, -3545, -34057, 8217374, -175116, -213468, -83314, -165981, 35527, -236363, -253628, 28353, 211623, -8409308, -8120912, -8236934, -194380, -8154595, -8421299, -8382958, -8580542, 228593, -20317, 114102, -248426, -143446, 244718, -16985751, -8536835, -8366077, -8189501, -16980258, -16530146, -205587, -8498781, -8201698, -8470042, -16765054, -8347242, -8130747, -8295309, -16750085, -16784547, 176683, 139265, -8601542, -8250926, -8609926, -8284704, -235633, -8267089, -8279452, -250388, -64251, -214822, -16621029, -8594331, -8364035, -140109, 38130, -8308764, -8398288, 166466, 204447, -172479, 7655, -117736, -8141219, 134331, 210879, -111335, 236033, -8627355, 177568, 231533, -60353, -8264465, -8330425, -42297, -4930, 80178, -204705, -8414687, -8344661, -8135049, 113755, -85229, -8171676, -16979322, -8252571, -8563691, -8561668, -8307902, -8573968, -16765730, -186978, -8247392, -8514846, 232132, 237049, -8381739, 93562, -184372, -8130292, -16771648, -8391651, -8583329, -8224215, -8385595, 46103, -8569877, 160873, 261671, -71595, -190737, 246879, 166049, 196094, 117166, 23006, -181102, -8278119, -88421, -8153878, 20078, -202049, -144683, 40742, 76786, -34850, -227831, -226294, 114300, -27312, -76377, -98900, 256250, 253004, 193910, 234782, -8267252, -8248120, 248758]]);
      final expectedRemaining = mockPolyVec([[8, 10, 10, 10, 13, 14, 13, 5, 6, 4, 15, 13, 10, 1, 10, 7, 10, 12, 2, 4, 11, 7, 3, 11, 12, 3, 8, 2, 7, 15, 1, 3, 11, 11, 14, 11, 13, 10, 2, 14, 6, 4, 1, 12, 14, 1, 3, 5, 7, 4, 7, 4, 8, 5, 14, 11, 3, 14, 6, 2, 8, 9, 6, 15, 4, 12, 3, 13, 2, 1, 0, 5, 11, 11, 14, 13, 8, 4, 13, 7, 13, 15, 15, 15, 14, 14, 0, 8, 13, 1, 3, 0, 14, 7, 7, 5, 7, 3, 10, 15, 14, 9, 2, 12, 3, 1, 12, 5, 5, 0, 4, 2, 6, 8, 14, 9, 1, 5, 5, 8, 6, 6, 14, 3, 1, 2, 8, 4, 15, 9, 6, 13, 15, 7, 5, 0, 8, 0, 6, 1, 12, 6, 11, 8, 13, 10, 0, 0, 15, 10, 13, 5, 5, 11, 10, 13, 2, 12, 15, 4, 15, 3, 1, 13, 5, 3, 3, 1, 12, 12, 14, 3, 7, 12, 10, 8, 3, 3, 10, 11, 15, 4, 1, 9, 12, 15, 4, 14, 0, 10, 7, 4, 0, 0, 13, 13, 10, 11, 3, 7, 6, 13, 1, 14, 11, 11, 10, 15, 3, 3, 14, 9, 4, 5, 1, 2, 10, 14, 3, 11, 0, 9, 1, 13, 10, 13, 2, 12, 8, 11, 8, 3, 7, 14, 13, 7, 8, 3, 4, 4, 5, 6, 1, 8, 5, 8, 13, 0, 6, 7, 10, 8, 0, 2, 15, 13]]);
      
      int gamma2 = (Dilithium.Q - 1) ~/ 32;
      final actual = pv.decompose(gamma2);

      expectPolyVecsAreEqual(expectedRounded, actual[0]);
      expectPolyVecsAreEqual(expectedRemaining, actual[1]);
    });

    test('chknorm', (){
      final coef = List<int>.generate(Dilithium.N, (index) => index % 100);
      final pv = mockPolyVec([coef]);

      expect(pv.chknorm(200), false);
      expect(pv.chknorm(50), true);
    });

    test('shift', (){
      final coef = List<int>.generate(Dilithium.N, (index) => index);
      final pv = mockPolyVec([coef]);
      final expected = mockPolyVec([[0, 8192, 16384, 24576, 32768, 40960, 49152, 57344, 65536, 73728, 81920, 90112, 98304, 106496, 114688, 122880, 131072, 139264, 147456, 155648, 163840, 172032, 180224, 188416, 196608, 204800, 212992, 221184, 229376, 237568, 245760, 253952, 262144, 270336, 278528, 286720, 294912, 303104, 311296, 319488, 327680, 335872, 344064, 352256, 360448, 368640, 376832, 385024, 393216, 401408, 409600, 417792, 425984, 434176, 442368, 450560, 458752, 466944, 475136, 483328, 491520, 499712, 507904, 516096, 524288, 532480, 540672, 548864, 557056, 565248, 573440, 581632, 589824, 598016, 606208, 614400, 622592, 630784, 638976, 647168, 655360, 663552, 671744, 679936, 688128, 696320, 704512, 712704, 720896, 729088, 737280, 745472, 753664, 761856, 770048, 778240, 786432, 794624, 802816, 811008, 819200, 827392, 835584, 843776, 851968, 860160, 868352, 876544, 884736, 892928, 901120, 909312, 917504, 925696, 933888, 942080, 950272, 958464, 966656, 974848, 983040, 991232, 999424, 1007616, 1015808, 1024000, 1032192, 1040384, 1048576, 1056768, 1064960, 1073152, 1081344, 1089536, 1097728, 1105920, 1114112, 1122304, 1130496, 1138688, 1146880, 1155072, 1163264, 1171456, 1179648, 1187840, 1196032, 1204224, 1212416, 1220608, 1228800, 1236992, 1245184, 1253376, 1261568, 1269760, 1277952, 1286144, 1294336, 1302528, 1310720, 1318912, 1327104, 1335296, 1343488, 1351680, 1359872, 1368064, 1376256, 1384448, 1392640, 1400832, 1409024, 1417216, 1425408, 1433600, 1441792, 1449984, 1458176, 1466368, 1474560, 1482752, 1490944, 1499136, 1507328, 1515520, 1523712, 1531904, 1540096, 1548288, 1556480, 1564672, 1572864, 1581056, 1589248, 1597440, 1605632, 1613824, 1622016, 1630208, 1638400, 1646592, 1654784, 1662976, 1671168, 1679360, 1687552, 1695744, 1703936, 1712128, 1720320, 1728512, 1736704, 1744896, 1753088, 1761280, 1769472, 1777664, 1785856, 1794048, 1802240, 1810432, 1818624, 1826816, 1835008, 1843200, 1851392, 1859584, 1867776, 1875968, 1884160, 1892352, 1900544, 1908736, 1916928, 1925120, 1933312, 1941504, 1949696, 1957888, 1966080, 1974272, 1982464, 1990656, 1998848, 2007040, 2015232, 2023424, 2031616, 2039808, 2048000, 2056192, 2064384, 2072576, 2080768, 2088960]]);

      final actual = pv.shift();

      expectPolyVecsAreEqual(expected, actual);
    });
  });
}